
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>第08章 数据规整：聚合、合并和重塑 · 利用Python进行数据分析·第2版</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="09.html" />
    
    
    <link rel="prev" href="07.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://www.mapull.com" target="_blank" class="custom-link">首页</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="01.html">
            
                <a href="01.html">
            
                    
                    第1章 准备工作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="02.html">
            
                <a href="02.html">
            
                    
                    第2章 Python语法基础，IPython和Jupyter Notebooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="03.html">
            
                <a href="03.html">
            
                    
                    第03章 Python的数据结构、函数和文件.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="04.html">
            
                <a href="04.html">
            
                    
                    第04章 NumPy基础、数组和矢量计算.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="05.html">
            
                <a href="05.html">
            
                    
                    第05章 pandas入门.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="06.html">
            
                <a href="06.html">
            
                    
                    第06章 数据加载、存储与文件格式.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="07.html">
            
                <a href="07.html">
            
                    
                    第07章 数据清洗和准备.md
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.9" data-path="08.html">
            
                <a href="08.html">
            
                    
                    第08章 数据规整：聚合、合并和重塑
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="09.html">
            
                <a href="09.html">
            
                    
                    第09章 绘图和可视化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="10.html">
            
                <a href="10.html">
            
                    
                    第10章 数据聚合与分组运算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="11.html">
            
                <a href="11.html">
            
                    
                    第11章 时间序列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="12.html">
            
                <a href="12.html">
            
                    
                    第12章 pandas高级应用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="13.html">
            
                <a href="13.html">
            
                    
                    第13章 Python建模库介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="14.html">
            
                <a href="14.html">
            
                    
                    第14章 数据分析案例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="15.html">
            
                <a href="15.html">
            
                    
                    附录A NumPy高级应用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="16.html">
            
                <a href="16.html">
            
                    
                    附录B 更多关于IPython的内容（完）
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >第08章 数据规整：聚合、合并和重塑</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>&#x5728;&#x8BB8;&#x591A;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x6570;&#x636E;&#x53EF;&#x80FD;&#x5206;&#x6563;&#x5728;&#x8BB8;&#x591A;&#x6587;&#x4EF6;&#x6216;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF0C;&#x5B58;&#x50A8;&#x7684;&#x5F62;&#x5F0F;&#x4E5F;&#x4E0D;&#x5229;&#x4E8E;&#x5206;&#x6790;&#x3002;&#x672C;&#x7AE0;&#x5173;&#x6CE8;&#x53EF;&#x4EE5;&#x805A;&#x5408;&#x3001;&#x5408;&#x5E76;&#x3001;&#x91CD;&#x5851;&#x6570;&#x636E;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4F1A;&#x4ECB;&#x7ECD;pandas&#x7684;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#xFF0C;&#x5B83;&#x5E7F;&#x6CDB;&#x7528;&#x4E8E;&#x4EE5;&#x4E0A;&#x64CD;&#x4F5C;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x6211;&#x6DF1;&#x5165;&#x4ECB;&#x7ECD;&#x4E86;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x7684;&#x6570;&#x636E;&#x64CD;&#x4F5C;&#x3002;&#x5728;&#x7B2C;14&#x7AE0;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x7684;&#x591A;&#x79CD;&#x5E94;&#x7528;&#x3002;</p>
<h1 id="81-&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;">8.1 &#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;</h1>
<p>&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#xFF08;hierarchical indexing&#xFF09;&#x662F;pandas&#x7684;&#x4E00;&#x9879;&#x91CD;&#x8981;&#x529F;&#x80FD;&#xFF0C;&#x5B83;&#x4F7F;&#x4F60;&#x80FD;&#x5728;&#x4E00;&#x4E2A;&#x8F74;&#x4E0A;&#x62E5;&#x6709;&#x591A;&#x4E2A;&#xFF08;&#x4E24;&#x4E2A;&#x4EE5;&#x4E0A;&#xFF09;&#x7D22;&#x5F15;&#x7EA7;&#x522B;&#x3002;&#x62BD;&#x8C61;&#x70B9;&#x8BF4;&#xFF0C;&#x5B83;&#x4F7F;&#x4F60;&#x80FD;&#x4EE5;&#x4F4E;&#x7EF4;&#x5EA6;&#x5F62;&#x5F0F;&#x5904;&#x7406;&#x9AD8;&#x7EF4;&#x5EA6;&#x6570;&#x636E;&#x3002;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Series&#xFF0C;&#x5E76;&#x7528;&#x4E00;&#x4E2A;&#x7531;&#x5217;&#x8868;&#x6216;&#x6570;&#x7EC4;&#x7EC4;&#x6210;&#x7684;&#x5217;&#x8868;&#x4F5C;&#x4E3A;&#x7D22;&#x5F15;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">9</span>]: data = pd.Series(np.random.randn(<span class="hljs-number">9</span>),
   ...:                  index=[[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>],
   ...:                         [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]])

In [<span class="hljs-number">10</span>]: data
Out[<span class="hljs-number">10</span>]: 
a  <span class="hljs-number">1</span>   <span class="hljs-number">-0.204708</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">0.478943</span>
   <span class="hljs-number">3</span>   <span class="hljs-number">-0.519439</span>
b  <span class="hljs-number">1</span>   <span class="hljs-number">-0.555730</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">1.965781</span>
c  <span class="hljs-number">1</span>    <span class="hljs-number">1.393406</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">0.092908</span>
d  <span class="hljs-number">2</span>    <span class="hljs-number">0.281746</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.769023</span>
dtype: float64
</code></pre>
<p>&#x770B;&#x5230;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x7ECF;&#x8FC7;&#x7F8E;&#x5316;&#x7684;&#x5E26;&#x6709;MultiIndex&#x7D22;&#x5F15;&#x7684;Series&#x7684;&#x683C;&#x5F0F;&#x3002;&#x7D22;&#x5F15;&#x4E4B;&#x95F4;&#x7684;&#x201C;&#x95F4;&#x9694;&#x201D;&#x8868;&#x793A;&#x201C;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x6807;&#x7B7E;&#x201D;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">11</span>]: data.index
Out[<span class="hljs-number">11</span>]: 
MultiIndex(levels=[[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]],
           labels=[[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]])
</code></pre>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6240;&#x8C13;&#x7684;&#x90E8;&#x5206;&#x7D22;&#x5F15;&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x9009;&#x53D6;&#x6570;&#x636E;&#x5B50;&#x96C6;&#x7684;&#x64CD;&#x4F5C;&#x66F4;&#x7B80;&#x5355;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">12</span>]: data[<span class="hljs-string">&apos;b&apos;</span>]
Out[<span class="hljs-number">12</span>]: 
<span class="hljs-number">1</span>   <span class="hljs-number">-0.555730</span>
<span class="hljs-number">3</span>    <span class="hljs-number">1.965781</span>
dtype: float64

In [<span class="hljs-number">13</span>]: data[<span class="hljs-string">&apos;b&apos;</span>:<span class="hljs-string">&apos;c&apos;</span>]
Out[<span class="hljs-number">13</span>]: 
b  <span class="hljs-number">1</span>   <span class="hljs-number">-0.555730</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">1.965781</span>
c  <span class="hljs-number">1</span>    <span class="hljs-number">1.393406</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">0.092908</span>
dtype: float64

In [<span class="hljs-number">14</span>]: data.loc[[<span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>]]
Out[<span class="hljs-number">14</span>]: 
b  <span class="hljs-number">1</span>   <span class="hljs-number">-0.555730</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">1.965781</span>
d  <span class="hljs-number">2</span>    <span class="hljs-number">0.281746</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.769023</span>
dtype: float64
</code></pre>
<p>&#x6709;&#x65F6;&#x751A;&#x81F3;&#x8FD8;&#x53EF;&#x4EE5;&#x5728;&#x201C;&#x5185;&#x5C42;&#x201D;&#x4E2D;&#x8FDB;&#x884C;&#x9009;&#x53D6;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">15</span>]: data.loc[:, <span class="hljs-number">2</span>]
Out[<span class="hljs-number">15</span>]: 
a    <span class="hljs-number">0.478943</span>
c    <span class="hljs-number">0.092908</span>
d    <span class="hljs-number">0.281746</span>
dtype: float64
</code></pre>
<p>&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#x5728;&#x6570;&#x636E;&#x91CD;&#x5851;&#x548C;&#x57FA;&#x4E8E;&#x5206;&#x7EC4;&#x7684;&#x64CD;&#x4F5C;&#xFF08;&#x5982;&#x900F;&#x89C6;&#x8868;&#x751F;&#x6210;&#xFF09;&#x4E2D;&#x626E;&#x6F14;&#x7740;&#x91CD;&#x8981;&#x7684;&#x89D2;&#x8272;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;unstack&#x65B9;&#x6CD5;&#x5C06;&#x8FD9;&#x6BB5;&#x6570;&#x636E;&#x91CD;&#x65B0;&#x5B89;&#x6392;&#x5230;&#x4E00;&#x4E2A;DataFrame&#x4E2D;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">16</span>]: data.unstack()
Out[<span class="hljs-number">16</span>]: 
          <span class="hljs-number">1</span>         <span class="hljs-number">2</span>         <span class="hljs-number">3</span>
a <span class="hljs-number">-0.204708</span>  <span class="hljs-number">0.478943</span> <span class="hljs-number">-0.519439</span>
b <span class="hljs-number">-0.555730</span>       NaN  <span class="hljs-number">1.965781</span>
c  <span class="hljs-number">1.393406</span>  <span class="hljs-number">0.092908</span>       NaN
d       NaN  <span class="hljs-number">0.281746</span>  <span class="hljs-number">0.769023</span>
</code></pre>
<p>unstack&#x7684;&#x9006;&#x8FD0;&#x7B97;&#x662F;stack&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">17</span>]: data.unstack().stack()
Out[<span class="hljs-number">17</span>]: 
a  <span class="hljs-number">1</span>   <span class="hljs-number">-0.204708</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">0.478943</span>
   <span class="hljs-number">3</span>   <span class="hljs-number">-0.519439</span>
b  <span class="hljs-number">1</span>   <span class="hljs-number">-0.555730</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">1.965781</span>
c  <span class="hljs-number">1</span>    <span class="hljs-number">1.393406</span>
   <span class="hljs-number">2</span>    <span class="hljs-number">0.092908</span>
d  <span class="hljs-number">2</span>    <span class="hljs-number">0.281746</span>
   <span class="hljs-number">3</span>    <span class="hljs-number">0.769023</span>
dtype: float64
</code></pre>
<p>stack&#x548C;unstack&#x5C06;&#x5728;&#x672C;&#x7AE0;&#x540E;&#x9762;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;DataFrame&#xFF0C;&#x6BCF;&#x6761;&#x8F74;&#x90FD;&#x53EF;&#x4EE5;&#x6709;&#x5206;&#x5C42;&#x7D22;&#x5F15;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">18</span>]: frame = pd.DataFrame(np.arange(<span class="hljs-number">12</span>).reshape((<span class="hljs-number">4</span>, <span class="hljs-number">3</span>)),
   ....:                      index=[[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]],
   ....:                      columns=[[<span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Colorado&apos;</span>],
   ....:                               [<span class="hljs-string">&apos;Green&apos;</span>, <span class="hljs-string">&apos;Red&apos;</span>, <span class="hljs-string">&apos;Green&apos;</span>]])

In [<span class="hljs-number">19</span>]: frame
Out[<span class="hljs-number">19</span>]: 
     Ohio     Colorado
    Green Red    Green
a <span class="hljs-number">1</span>     <span class="hljs-number">0</span>   <span class="hljs-number">1</span>        <span class="hljs-number">2</span>
  <span class="hljs-number">2</span>     <span class="hljs-number">3</span>   <span class="hljs-number">4</span>        <span class="hljs-number">5</span>
b <span class="hljs-number">1</span>     <span class="hljs-number">6</span>   <span class="hljs-number">7</span>        <span class="hljs-number">8</span>
  <span class="hljs-number">2</span>     <span class="hljs-number">9</span>  <span class="hljs-number">10</span>       <span class="hljs-number">11</span>
</code></pre>
<p>&#x5404;&#x5C42;&#x90FD;&#x53EF;&#x4EE5;&#x6709;&#x540D;&#x5B57;&#xFF08;&#x53EF;&#x4EE5;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x522B;&#x7684;Python&#x5BF9;&#x8C61;&#xFF09;&#x3002;&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;&#x540D;&#x79F0;&#xFF0C;&#x5B83;&#x4EEC;&#x5C31;&#x4F1A;&#x663E;&#x793A;&#x5728;&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#x4E2D;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">20</span>]: frame.index.names = [<span class="hljs-string">&apos;key1&apos;</span>, <span class="hljs-string">&apos;key2&apos;</span>]

In [<span class="hljs-number">21</span>]: frame.columns.names = [<span class="hljs-string">&apos;state&apos;</span>, <span class="hljs-string">&apos;color&apos;</span>]

In [<span class="hljs-number">22</span>]: frame
Out[<span class="hljs-number">22</span>]: 
state      Ohio     Colorado
color     Green Red    Green
key1 key2                   
a    <span class="hljs-number">1</span>        <span class="hljs-number">0</span>   <span class="hljs-number">1</span>        <span class="hljs-number">2</span>
     <span class="hljs-number">2</span>        <span class="hljs-number">3</span>   <span class="hljs-number">4</span>        <span class="hljs-number">5</span>
b    <span class="hljs-number">1</span>        <span class="hljs-number">6</span>   <span class="hljs-number">7</span>        <span class="hljs-number">8</span>
     <span class="hljs-number">2</span>        <span class="hljs-number">9</span>  <span class="hljs-number">10</span>       <span class="hljs-number">11</span>
</code></pre>
<blockquote>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x5C0F;&#x5FC3;&#x533A;&#x5206;&#x7D22;&#x5F15;&#x540D;state&#x3001;color&#x4E0E;&#x884C;&#x6807;&#x7B7E;&#x3002;</p>
</blockquote>
<p>&#x6709;&#x4E86;&#x90E8;&#x5206;&#x5217;&#x7D22;&#x5F15;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x9009;&#x53D6;&#x5217;&#x5206;&#x7EC4;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">23</span>]: frame[<span class="hljs-string">&apos;Ohio&apos;</span>]
Out[<span class="hljs-number">23</span>]: 
color      Green  Red
key1 key2            
a    <span class="hljs-number">1</span>         <span class="hljs-number">0</span>    <span class="hljs-number">1</span>
     <span class="hljs-number">2</span>         <span class="hljs-number">3</span>    <span class="hljs-number">4</span>
b    <span class="hljs-number">1</span>         <span class="hljs-number">6</span>    <span class="hljs-number">7</span>
     <span class="hljs-number">2</span>         <span class="hljs-number">9</span>   <span class="hljs-number">10</span>
</code></pre>
<p>&#x53EF;&#x4EE5;&#x5355;&#x72EC;&#x521B;&#x5EFA;MultiIndex&#x7136;&#x540E;&#x590D;&#x7528;&#x3002;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;DataFrame&#x4E2D;&#x7684;&#xFF08;&#x5E26;&#x6709;&#x5206;&#x7EA7;&#x540D;&#x79F0;&#xFF09;&#x5217;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x521B;&#x5EFA;&#xFF1A;</p>
<pre><code class="lang-python">MultiIndex.from_arrays([[<span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Colorado&apos;</span>], [<span class="hljs-string">&apos;Green&apos;</span>, <span class="hljs-string">&apos;Red&apos;</span>, <span class="hljs-string">&apos;Green&apos;</span>]],
                       names=[<span class="hljs-string">&apos;state&apos;</span>, <span class="hljs-string">&apos;color&apos;</span>])
</code></pre>
<h2 id="&#x91CD;&#x6392;&#x4E0E;&#x5206;&#x7EA7;&#x6392;&#x5E8F;">&#x91CD;&#x6392;&#x4E0E;&#x5206;&#x7EA7;&#x6392;&#x5E8F;</h2>
<p>&#x6709;&#x65F6;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x8C03;&#x6574;&#x67D0;&#x6761;&#x8F74;&#x4E0A;&#x5404;&#x7EA7;&#x522B;&#x7684;&#x987A;&#x5E8F;&#xFF0C;&#x6216;&#x6839;&#x636E;&#x6307;&#x5B9A;&#x7EA7;&#x522B;&#x4E0A;&#x7684;&#x503C;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#x3002;swaplevel&#x63A5;&#x53D7;&#x4E24;&#x4E2A;&#x7EA7;&#x522B;&#x7F16;&#x53F7;&#x6216;&#x540D;&#x79F0;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x4E92;&#x6362;&#x4E86;&#x7EA7;&#x522B;&#x7684;&#x65B0;&#x5BF9;&#x8C61;&#xFF08;&#x4F46;&#x6570;&#x636E;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF09;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">24</span>]: frame.swaplevel(<span class="hljs-string">&apos;key1&apos;</span>, <span class="hljs-string">&apos;key2&apos;</span>)
Out[<span class="hljs-number">24</span>]: 
state      Ohio     Colorado
color     Green Red    Green
key2 key1                   
<span class="hljs-number">1</span>    a        <span class="hljs-number">0</span>   <span class="hljs-number">1</span>        <span class="hljs-number">2</span>
<span class="hljs-number">2</span>    a        <span class="hljs-number">3</span>   <span class="hljs-number">4</span>        <span class="hljs-number">5</span>
<span class="hljs-number">1</span>    b        <span class="hljs-number">6</span>   <span class="hljs-number">7</span>        <span class="hljs-number">8</span>
<span class="hljs-number">2</span>    b        <span class="hljs-number">9</span>  <span class="hljs-number">10</span>       <span class="hljs-number">11</span>
</code></pre>
<p>&#x800C;sort_index&#x5219;&#x6839;&#x636E;&#x5355;&#x4E2A;&#x7EA7;&#x522B;&#x4E2D;&#x7684;&#x503C;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#x3002;&#x4EA4;&#x6362;&#x7EA7;&#x522B;&#x65F6;&#xFF0C;&#x5E38;&#x5E38;&#x4E5F;&#x4F1A;&#x7528;&#x5230;sort_index&#xFF0C;&#x8FD9;&#x6837;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#x5C31;&#x662F;&#x6309;&#x7167;&#x6307;&#x5B9A;&#x987A;&#x5E8F;&#x8FDB;&#x884C;&#x5B57;&#x6BCD;&#x6392;&#x5E8F;&#x4E86;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">25</span>]: frame.sort_index(level=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">25</span>]: 
state      Ohio     Colorado
color     Green Red    Green
key1 key2                   
a    <span class="hljs-number">1</span>        <span class="hljs-number">0</span>   <span class="hljs-number">1</span>        <span class="hljs-number">2</span>
b    <span class="hljs-number">1</span>        <span class="hljs-number">6</span>   <span class="hljs-number">7</span>        <span class="hljs-number">8</span>
a    <span class="hljs-number">2</span>        <span class="hljs-number">3</span>   <span class="hljs-number">4</span>        <span class="hljs-number">5</span>
b    <span class="hljs-number">2</span>        <span class="hljs-number">9</span>  <span class="hljs-number">10</span>       <span class="hljs-number">11</span>

In [<span class="hljs-number">26</span>]: frame.swaplevel(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>).sort_index(level=<span class="hljs-number">0</span>)
Out[<span class="hljs-number">26</span>]: 
state      Ohio     Colorado
color     Green Red    Green
key2 key1                   
<span class="hljs-number">1</span>    a        <span class="hljs-number">0</span>   <span class="hljs-number">1</span>        <span class="hljs-number">2</span>
     b        <span class="hljs-number">6</span>   <span class="hljs-number">7</span>        <span class="hljs-number">8</span>
<span class="hljs-number">2</span>    a        <span class="hljs-number">3</span>   <span class="hljs-number">4</span>        <span class="hljs-number">5</span>
     b        <span class="hljs-number">9</span>  <span class="hljs-number">10</span>       <span class="hljs-number">11</span>
</code></pre>
<h2 id="&#x6839;&#x636E;&#x7EA7;&#x522B;&#x6C47;&#x603B;&#x7EDF;&#x8BA1;">&#x6839;&#x636E;&#x7EA7;&#x522B;&#x6C47;&#x603B;&#x7EDF;&#x8BA1;</h2>
<p>&#x8BB8;&#x591A;&#x5BF9;DataFrame&#x548C;Series&#x7684;&#x63CF;&#x8FF0;&#x548C;&#x6C47;&#x603B;&#x7EDF;&#x8BA1;&#x90FD;&#x6709;&#x4E00;&#x4E2A;level&#x9009;&#x9879;&#xFF0C;&#x5B83;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x5728;&#x67D0;&#x6761;&#x8F74;&#x4E0A;&#x6C42;&#x548C;&#x7684;&#x7EA7;&#x522B;&#x3002;&#x518D;&#x4EE5;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;DataFrame&#x4E3A;&#x4F8B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x884C;&#x6216;&#x5217;&#x4E0A;&#x7684;&#x7EA7;&#x522B;&#x6765;&#x8FDB;&#x884C;&#x6C42;&#x548C;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">27</span>]: frame.sum(level=<span class="hljs-string">&apos;key2&apos;</span>)
Out[<span class="hljs-number">27</span>]: 
state  Ohio     Colorado
color Green Red    Green
key2                    
<span class="hljs-number">1</span>         <span class="hljs-number">6</span>   <span class="hljs-number">8</span>       <span class="hljs-number">10</span>
<span class="hljs-number">2</span>        <span class="hljs-number">12</span>  <span class="hljs-number">14</span>       <span class="hljs-number">16</span>

In [<span class="hljs-number">28</span>]: frame.sum(level=<span class="hljs-string">&apos;color&apos;</span>, axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">28</span>]: 
color      Green  Red
key1 key2            
a    <span class="hljs-number">1</span>         <span class="hljs-number">2</span>    <span class="hljs-number">1</span>
     <span class="hljs-number">2</span>         <span class="hljs-number">8</span>    <span class="hljs-number">4</span>
b    <span class="hljs-number">1</span>        <span class="hljs-number">14</span>    <span class="hljs-number">7</span>
     <span class="hljs-number">2</span>        <span class="hljs-number">20</span>   <span class="hljs-number">10</span>
</code></pre>
<p>&#x8FD9;&#x5176;&#x5B9E;&#x662F;&#x5229;&#x7528;&#x4E86;pandas&#x7684;groupby&#x529F;&#x80FD;&#xFF0C;&#x672C;&#x4E66;&#x7A0D;&#x540E;&#x5C06;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#x3002;</p>
<h2 id="&#x4F7F;&#x7528;dataframe&#x7684;&#x5217;&#x8FDB;&#x884C;&#x7D22;&#x5F15;">&#x4F7F;&#x7528;DataFrame&#x7684;&#x5217;&#x8FDB;&#x884C;&#x7D22;&#x5F15;</h2>
<p>&#x4EBA;&#x4EEC;&#x7ECF;&#x5E38;&#x60F3;&#x8981;&#x5C06;DataFrame&#x7684;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5217;&#x5F53;&#x505A;&#x884C;&#x7D22;&#x5F15;&#x6765;&#x7528;&#xFF0C;&#x6216;&#x8005;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x5C06;&#x884C;&#x7D22;&#x5F15;&#x53D8;&#x6210;DataFrame&#x7684;&#x5217;&#x3002;&#x4EE5;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;DataFrame&#x4E3A;&#x4F8B;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">29</span>]: frame = pd.DataFrame({<span class="hljs-string">&apos;a&apos;</span>: range(<span class="hljs-number">7</span>), <span class="hljs-string">&apos;b&apos;</span>: range(<span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>),
   ....:                       <span class="hljs-string">&apos;c&apos;</span>: [<span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;two&apos;</span>, <span class="hljs-string">&apos;two&apos;</span>,
   ....:                             <span class="hljs-string">&apos;two&apos;</span>, <span class="hljs-string">&apos;two&apos;</span>],
   ....:                       <span class="hljs-string">&apos;d&apos;</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]})

In [<span class="hljs-number">30</span>]: frame
Out[<span class="hljs-number">30</span>]: 
   a  b    c  d
<span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">7</span>  one  <span class="hljs-number">0</span>
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">6</span>  one  <span class="hljs-number">1</span>
<span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  one  <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  two  <span class="hljs-number">0</span>
<span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">3</span>  two  <span class="hljs-number">1</span>
<span class="hljs-number">5</span>  <span class="hljs-number">5</span>  <span class="hljs-number">2</span>  two  <span class="hljs-number">2</span>
<span class="hljs-number">6</span>  <span class="hljs-number">6</span>  <span class="hljs-number">1</span>  two  <span class="hljs-number">3</span>
</code></pre>
<p>DataFrame&#x7684;set_index&#x51FD;&#x6570;&#x4F1A;&#x5C06;&#x5176;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5217;&#x8F6C;&#x6362;&#x4E3A;&#x884C;&#x7D22;&#x5F15;&#xFF0C;&#x5E76;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;DataFrame&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">31</span>]: frame2 = frame.set_index([<span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>])

In [<span class="hljs-number">32</span>]: frame2
Out[<span class="hljs-number">32</span>]: 
       a  b
c   d      
one <span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">7</span>
    <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">6</span>
    <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">5</span>
two <span class="hljs-number">0</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
    <span class="hljs-number">1</span>  <span class="hljs-number">4</span>  <span class="hljs-number">3</span>
    <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  <span class="hljs-number">2</span>
    <span class="hljs-number">3</span>  <span class="hljs-number">6</span>  <span class="hljs-number">1</span>
</code></pre>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x90A3;&#x4E9B;&#x5217;&#x4F1A;&#x4ECE;DataFrame&#x4E2D;&#x79FB;&#x9664;&#xFF0C;&#x4F46;&#x4E5F;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x4FDD;&#x7559;&#x4E0B;&#x6765;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">33</span>]: frame.set_index([<span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>], drop=<span class="hljs-keyword">False</span>)
Out[<span class="hljs-number">33</span>]: 
       a  b    c  d
c   d              
one <span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">7</span>  one  <span class="hljs-number">0</span>
    <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">6</span>  one  <span class="hljs-number">1</span>
    <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  one  <span class="hljs-number">2</span>
two <span class="hljs-number">0</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  two  <span class="hljs-number">0</span>
    <span class="hljs-number">1</span>  <span class="hljs-number">4</span>  <span class="hljs-number">3</span>  two  <span class="hljs-number">1</span>
    <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  <span class="hljs-number">2</span>  two  <span class="hljs-number">2</span>
    <span class="hljs-number">3</span>  <span class="hljs-number">6</span>  <span class="hljs-number">1</span>  two  <span class="hljs-number">3</span>
</code></pre>
<p>reset_index&#x7684;&#x529F;&#x80FD;&#x8DDF;set_index&#x521A;&#x597D;&#x76F8;&#x53CD;&#xFF0C;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#x7684;&#x7EA7;&#x522B;&#x4F1A;&#x88AB;&#x8F6C;&#x79FB;&#x5230;&#x5217;&#x91CC;&#x9762;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">34</span>]: frame2.reset_index()
Out[<span class="hljs-number">34</span>]:
c  d  a  b
<span class="hljs-number">0</span>  one  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">7</span>
<span class="hljs-number">1</span>  one  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">6</span>
<span class="hljs-number">2</span>  one  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">5</span>
<span class="hljs-number">3</span>  two  <span class="hljs-number">0</span>  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>
<span class="hljs-number">4</span>  two  <span class="hljs-number">1</span>  <span class="hljs-number">4</span>  <span class="hljs-number">3</span>
<span class="hljs-number">5</span>  two  <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  <span class="hljs-number">2</span>
<span class="hljs-number">6</span>  two  <span class="hljs-number">3</span>  <span class="hljs-number">6</span>  <span class="hljs-number">1</span>
</code></pre>
<h1 id="82-&#x5408;&#x5E76;&#x6570;&#x636E;&#x96C6;">8.2 &#x5408;&#x5E76;&#x6570;&#x636E;&#x96C6;</h1>
<p>pandas&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#xFF1A;</p>
<ul>
<li>pandas.merge&#x53EF;&#x6839;&#x636E;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x952E;&#x5C06;&#x4E0D;&#x540C;DataFrame&#x4E2D;&#x7684;&#x884C;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x3002;SQL&#x6216;&#x5176;&#x4ED6;&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7528;&#x6237;&#x5BF9;&#x6B64;&#x5E94;&#x8BE5;&#x4F1A;&#x6BD4;&#x8F83;&#x719F;&#x6089;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5B9E;&#x73B0;&#x7684;&#x5C31;&#x662F;&#x6570;&#x636E;&#x5E93;&#x7684;join&#x64CD;&#x4F5C;&#x3002;</li>
<li>pandas.concat&#x53EF;&#x4EE5;&#x6CBF;&#x7740;&#x4E00;&#x6761;&#x8F74;&#x5C06;&#x591A;&#x4E2A;&#x5BF9;&#x8C61;&#x5806;&#x53E0;&#x5230;&#x4E00;&#x8D77;&#x3002;</li>
<li>&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;combine_first&#x53EF;&#x4EE5;&#x5C06;&#x91CD;&#x590D;&#x6570;&#x636E;&#x62FC;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x7528;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x503C;&#x586B;&#x5145;&#x53E6;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x7F3A;&#x5931;&#x503C;&#x3002;</li>
</ul>
<p>&#x6211;&#x5C06;&#x5206;&#x522B;&#x5BF9;&#x5B83;&#x4EEC;&#x8FDB;&#x884C;&#x8BB2;&#x89E3;&#xFF0C;&#x5E76;&#x7ED9;&#x51FA;&#x4E00;&#x4E9B;&#x4F8B;&#x5B50;&#x3002;&#x672C;&#x4E66;&#x5269;&#x4F59;&#x90E8;&#x5206;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#x5C06;&#x7ECF;&#x5E38;&#x7528;&#x5230;&#x5B83;&#x4EEC;&#x3002;</p>
<h2 id="&#x6570;&#x636E;&#x5E93;&#x98CE;&#x683C;&#x7684;dataframe&#x5408;&#x5E76;">&#x6570;&#x636E;&#x5E93;&#x98CE;&#x683C;&#x7684;DataFrame&#x5408;&#x5E76;</h2>
<p>&#x6570;&#x636E;&#x96C6;&#x7684;&#x5408;&#x5E76;&#xFF08;merge&#xFF09;&#x6216;&#x8FDE;&#x63A5;&#xFF08;join&#xFF09;&#x8FD0;&#x7B97;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x952E;&#x5C06;&#x884C;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7684;&#x3002;&#x8FD9;&#x4E9B;&#x8FD0;&#x7B97;&#x662F;&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#xFF08;&#x57FA;&#x4E8E;SQL&#xFF09;&#x7684;&#x6838;&#x5FC3;&#x3002;pandas&#x7684;merge&#x51FD;&#x6570;&#x662F;&#x5BF9;&#x6570;&#x636E;&#x5E94;&#x7528;&#x8FD9;&#x4E9B;&#x7B97;&#x6CD5;&#x7684;&#x4E3B;&#x8981;&#x5207;&#x5165;&#x70B9;&#x3002;</p>
<p>&#x4EE5;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#x5F00;&#x59CB;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">35</span>]: df1 = pd.DataFrame({<span class="hljs-string">&apos;key&apos;</span>: [<span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>],
   ....:                     <span class="hljs-string">&apos;data1&apos;</span>: range(<span class="hljs-number">7</span>)})

In [<span class="hljs-number">36</span>]: df2 = pd.DataFrame({<span class="hljs-string">&apos;key&apos;</span>: [<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>],
   ....:                     <span class="hljs-string">&apos;data2&apos;</span>: range(<span class="hljs-number">3</span>)})

In [<span class="hljs-number">37</span>]: df1
Out[<span class="hljs-number">37</span>]: 
   data1 key
<span class="hljs-number">0</span>      <span class="hljs-number">0</span>   b
<span class="hljs-number">1</span>      <span class="hljs-number">1</span>   b
<span class="hljs-number">2</span>      <span class="hljs-number">2</span>   a
<span class="hljs-number">3</span>      <span class="hljs-number">3</span>   c
<span class="hljs-number">4</span>      <span class="hljs-number">4</span>   a
<span class="hljs-number">5</span>      <span class="hljs-number">5</span>   a
<span class="hljs-number">6</span>      <span class="hljs-number">6</span>   b

In [<span class="hljs-number">38</span>]: df2
Out[<span class="hljs-number">38</span>]: 
   data2 key
<span class="hljs-number">0</span>      <span class="hljs-number">0</span>   a
<span class="hljs-number">1</span>      <span class="hljs-number">1</span>   b
<span class="hljs-number">2</span>      <span class="hljs-number">2</span>   d
</code></pre>
<p>&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x591A;&#x5BF9;&#x4E00;&#x7684;&#x5408;&#x5E76;&#x3002;df1&#x4E2D;&#x7684;&#x6570;&#x636E;&#x6709;&#x591A;&#x4E2A;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;a&#x548C;b&#x7684;&#x884C;&#xFF0C;&#x800C;df2&#x4E2D;key&#x5217;&#x7684;&#x6BCF;&#x4E2A;&#x503C;&#x5219;&#x4EC5;&#x5BF9;&#x5E94;&#x4E00;&#x884C;&#x3002;&#x5BF9;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x8C03;&#x7528;merge&#x5373;&#x53EF;&#x5F97;&#x5230;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">39</span>]: pd.merge(df1, df2)
Out[<span class="hljs-number">39</span>]: 
   data1 key  data2
<span class="hljs-number">0</span>      <span class="hljs-number">0</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">1</span>      <span class="hljs-number">1</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">2</span>      <span class="hljs-number">6</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">3</span>      <span class="hljs-number">2</span>   a      <span class="hljs-number">0</span>
<span class="hljs-number">4</span>      <span class="hljs-number">4</span>   a      <span class="hljs-number">0</span>
<span class="hljs-number">5</span>      <span class="hljs-number">5</span>   a      <span class="hljs-number">0</span>
</code></pre>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x6211;&#x5E76;&#x6CA1;&#x6709;&#x6307;&#x660E;&#x8981;&#x7528;&#x54EA;&#x4E2A;&#x5217;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#xFF0C;merge&#x5C31;&#x4F1A;&#x5C06;&#x91CD;&#x53E0;&#x5217;&#x7684;&#x5217;&#x540D;&#x5F53;&#x505A;&#x952E;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x6700;&#x597D;&#x660E;&#x786E;&#x6307;&#x5B9A;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">40</span>]: pd.merge(df1, df2, on=<span class="hljs-string">&apos;key&apos;</span>)
Out[<span class="hljs-number">40</span>]: 
   data1 key  data2
<span class="hljs-number">0</span>      <span class="hljs-number">0</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">1</span>      <span class="hljs-number">1</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">2</span>      <span class="hljs-number">6</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">3</span>      <span class="hljs-number">2</span>   a      <span class="hljs-number">0</span>
<span class="hljs-number">4</span>      <span class="hljs-number">4</span>   a      <span class="hljs-number">0</span>
<span class="hljs-number">5</span>      <span class="hljs-number">5</span>   a      <span class="hljs-number">0</span>
</code></pre>
<p>&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x5217;&#x540D;&#x4E0D;&#x540C;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5206;&#x522B;&#x8FDB;&#x884C;&#x6307;&#x5B9A;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">41</span>]: df3 = pd.DataFrame({<span class="hljs-string">&apos;lkey&apos;</span>: [<span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>],
   ....:                     <span class="hljs-string">&apos;data1&apos;</span>: range(<span class="hljs-number">7</span>)})

In [<span class="hljs-number">42</span>]: df4 = pd.DataFrame({<span class="hljs-string">&apos;rkey&apos;</span>: [<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>],
   ....:                     <span class="hljs-string">&apos;data2&apos;</span>: range(<span class="hljs-number">3</span>)})

In [<span class="hljs-number">43</span>]: pd.merge(df3, df4, left_on=<span class="hljs-string">&apos;lkey&apos;</span>, right_on=<span class="hljs-string">&apos;rkey&apos;</span>)
Out[<span class="hljs-number">43</span>]: 
   data1 lkey  data2 rkey
<span class="hljs-number">0</span>      <span class="hljs-number">0</span>    b      <span class="hljs-number">1</span>    b
<span class="hljs-number">1</span>      <span class="hljs-number">1</span>    b      <span class="hljs-number">1</span>    b
<span class="hljs-number">2</span>      <span class="hljs-number">6</span>    b      <span class="hljs-number">1</span>    b
<span class="hljs-number">3</span>      <span class="hljs-number">2</span>    a      <span class="hljs-number">0</span>    a
<span class="hljs-number">4</span>      <span class="hljs-number">4</span>    a      <span class="hljs-number">0</span>    a
<span class="hljs-number">5</span>      <span class="hljs-number">5</span>    a      <span class="hljs-number">0</span>    a
</code></pre>
<p>&#x53EF;&#x80FD;&#x4F60;&#x5DF2;&#x7ECF;&#x6CE8;&#x610F;&#x5230;&#x4E86;&#xFF0C;&#x7ED3;&#x679C;&#x91CC;&#x9762;c&#x548C;d&#x4EE5;&#x53CA;&#x4E0E;&#x4E4B;&#x76F8;&#x5173;&#x7684;&#x6570;&#x636E;&#x6D88;&#x5931;&#x4E86;&#x3002;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;merge&#x505A;&#x7684;&#x662F;&#x201C;&#x5185;&#x8FDE;&#x63A5;&#x201D;&#xFF1B;&#x7ED3;&#x679C;&#x4E2D;&#x7684;&#x952E;&#x662F;&#x4EA4;&#x96C6;&#x3002;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x8FD8;&#x6709;&quot;left&quot;&#x3001;&quot;right&quot;&#x4EE5;&#x53CA;&quot;outer&quot;&#x3002;&#x5916;&#x8FDE;&#x63A5;&#x6C42;&#x53D6;&#x7684;&#x662F;&#x952E;&#x7684;&#x5E76;&#x96C6;&#xFF0C;&#x7EC4;&#x5408;&#x4E86;&#x5DE6;&#x8FDE;&#x63A5;&#x548C;&#x53F3;&#x8FDE;&#x63A5;&#x7684;&#x6548;&#x679C;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">44</span>]: pd.merge(df1, df2, how=<span class="hljs-string">&apos;outer&apos;</span>)
Out[<span class="hljs-number">44</span>]: 
   data1 key  data2
<span class="hljs-number">0</span>    <span class="hljs-number">0.0</span>   b    <span class="hljs-number">1.0</span>
<span class="hljs-number">1</span>    <span class="hljs-number">1.0</span>   b    <span class="hljs-number">1.0</span>
<span class="hljs-number">2</span>    <span class="hljs-number">6.0</span>   b    <span class="hljs-number">1.0</span>
<span class="hljs-number">3</span>    <span class="hljs-number">2.0</span>   a    <span class="hljs-number">0.0</span>
<span class="hljs-number">4</span>    <span class="hljs-number">4.0</span>   a    <span class="hljs-number">0.0</span>
<span class="hljs-number">5</span>    <span class="hljs-number">5.0</span>   a    <span class="hljs-number">0.0</span>
<span class="hljs-number">6</span>    <span class="hljs-number">3.0</span>   c    NaN
<span class="hljs-number">7</span>    NaN   d    <span class="hljs-number">2.0</span>
</code></pre>
<p>&#x8868;8-1&#x5BF9;&#x8FD9;&#x4E9B;&#x9009;&#x9879;&#x8FDB;&#x884C;&#x4E86;&#x603B;&#x7ED3;&#x3002;</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-e49b3341f4a3c90e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x8868;8-1 &#x4E0D;&#x540C;&#x7684;&#x8FDE;&#x63A5;&#x7C7B;&#x578B;"></p>
<p>&#x591A;&#x5BF9;&#x591A;&#x7684;&#x5408;&#x5E76;&#x6709;&#x4E9B;&#x4E0D;&#x76F4;&#x89C2;&#x3002;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">45</span>]: df1 = pd.DataFrame({<span class="hljs-string">&apos;key&apos;</span>: [<span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>],
   ....:                     <span class="hljs-string">&apos;data1&apos;</span>: range(<span class="hljs-number">6</span>)})

In [<span class="hljs-number">46</span>]: df2 = pd.DataFrame({<span class="hljs-string">&apos;key&apos;</span>: [<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>],
   ....:                     <span class="hljs-string">&apos;data2&apos;</span>: range(<span class="hljs-number">5</span>)})

In [<span class="hljs-number">47</span>]: df1
Out[<span class="hljs-number">47</span>]: 
   data1 key
<span class="hljs-number">0</span>      <span class="hljs-number">0</span>   b
<span class="hljs-number">1</span>      <span class="hljs-number">1</span>   b
<span class="hljs-number">2</span>      <span class="hljs-number">2</span>   a
<span class="hljs-number">3</span>      <span class="hljs-number">3</span>   c
<span class="hljs-number">4</span>      <span class="hljs-number">4</span>   a
<span class="hljs-number">5</span>      <span class="hljs-number">5</span>   b

In [<span class="hljs-number">48</span>]: df2
Out[<span class="hljs-number">48</span>]: 
   data2 key
<span class="hljs-number">0</span>      <span class="hljs-number">0</span>   a
<span class="hljs-number">1</span>      <span class="hljs-number">1</span>   b
<span class="hljs-number">2</span>      <span class="hljs-number">2</span>   a
<span class="hljs-number">3</span>      <span class="hljs-number">3</span>   b
<span class="hljs-number">4</span>      <span class="hljs-number">4</span>   d

In [<span class="hljs-number">49</span>]: pd.merge(df1, df2, on=<span class="hljs-string">&apos;key&apos;</span>, how=<span class="hljs-string">&apos;left&apos;</span>)
Out[<span class="hljs-number">49</span>]: 
    data1 key  data2
<span class="hljs-number">0</span>       <span class="hljs-number">0</span>   b    <span class="hljs-number">1.0</span>
<span class="hljs-number">1</span>       <span class="hljs-number">0</span>   b    <span class="hljs-number">3.0</span>
<span class="hljs-number">2</span>       <span class="hljs-number">1</span>   b    <span class="hljs-number">1.0</span>
<span class="hljs-number">3</span>       <span class="hljs-number">1</span>   b    <span class="hljs-number">3.0</span>
<span class="hljs-number">4</span>       <span class="hljs-number">2</span>   a    <span class="hljs-number">0.0</span>
<span class="hljs-number">5</span>       <span class="hljs-number">2</span>   a    <span class="hljs-number">2.0</span>
<span class="hljs-number">6</span>       <span class="hljs-number">3</span>   c    NaN
<span class="hljs-number">7</span>       <span class="hljs-number">4</span>   a    <span class="hljs-number">0.0</span>
<span class="hljs-number">8</span>       <span class="hljs-number">4</span>   a    <span class="hljs-number">2.0</span>
<span class="hljs-number">9</span>       <span class="hljs-number">5</span>   b    <span class="hljs-number">1.0</span>
<span class="hljs-number">10</span>      <span class="hljs-number">5</span>   b    <span class="hljs-number">3.0</span>
</code></pre>
<p>&#x591A;&#x5BF9;&#x591A;&#x8FDE;&#x63A5;&#x4EA7;&#x751F;&#x7684;&#x662F;&#x884C;&#x7684;&#x7B1B;&#x5361;&#x5C14;&#x79EF;&#x3002;&#x7531;&#x4E8E;&#x5DE6;&#x8FB9;&#x7684;DataFrame&#x6709;3&#x4E2A;&quot;b&quot;&#x884C;&#xFF0C;&#x53F3;&#x8FB9;&#x7684;&#x6709;2&#x4E2A;&#xFF0C;&#x6240;&#x4EE5;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#x4E2D;&#x5C31;&#x6709;6&#x4E2A;&quot;b&quot;&#x884C;&#x3002;&#x8FDE;&#x63A5;&#x65B9;&#x5F0F;&#x53EA;&#x5F71;&#x54CD;&#x51FA;&#x73B0;&#x5728;&#x7ED3;&#x679C;&#x4E2D;&#x7684;&#x4E0D;&#x540C;&#x7684;&#x952E;&#x7684;&#x503C;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">50</span>]: pd.merge(df1, df2, how=<span class="hljs-string">&apos;inner&apos;</span>)
Out[<span class="hljs-number">50</span>]: 
   data1 key  data2
<span class="hljs-number">0</span>      <span class="hljs-number">0</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">1</span>      <span class="hljs-number">0</span>   b      <span class="hljs-number">3</span>
<span class="hljs-number">2</span>      <span class="hljs-number">1</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">3</span>      <span class="hljs-number">1</span>   b      <span class="hljs-number">3</span>
<span class="hljs-number">4</span>      <span class="hljs-number">5</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">5</span>      <span class="hljs-number">5</span>   b      <span class="hljs-number">3</span>
<span class="hljs-number">6</span>      <span class="hljs-number">2</span>   a      <span class="hljs-number">0</span>
<span class="hljs-number">7</span>      <span class="hljs-number">2</span>   a      <span class="hljs-number">2</span>
<span class="hljs-number">8</span>      <span class="hljs-number">4</span>   a      <span class="hljs-number">0</span>
<span class="hljs-number">9</span>      <span class="hljs-number">4</span>   a      <span class="hljs-number">2</span>
</code></pre>
<p>&#x8981;&#x6839;&#x636E;&#x591A;&#x4E2A;&#x952E;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#xFF0C;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x7531;&#x5217;&#x540D;&#x7EC4;&#x6210;&#x7684;&#x5217;&#x8868;&#x5373;&#x53EF;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">51</span>]: left = pd.DataFrame({<span class="hljs-string">&apos;key1&apos;</span>: [<span class="hljs-string">&apos;foo&apos;</span>, <span class="hljs-string">&apos;foo&apos;</span>, <span class="hljs-string">&apos;bar&apos;</span>],
   ....:                      <span class="hljs-string">&apos;key2&apos;</span>: [<span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;two&apos;</span>, <span class="hljs-string">&apos;one&apos;</span>],
   ....:                      <span class="hljs-string">&apos;lval&apos;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]})

In [<span class="hljs-number">52</span>]: right = pd.DataFrame({<span class="hljs-string">&apos;key1&apos;</span>: [<span class="hljs-string">&apos;foo&apos;</span>, <span class="hljs-string">&apos;foo&apos;</span>, <span class="hljs-string">&apos;bar&apos;</span>, <span class="hljs-string">&apos;bar&apos;</span>],
   ....:                       <span class="hljs-string">&apos;key2&apos;</span>: [<span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;two&apos;</span>],
   ....:                       <span class="hljs-string">&apos;rval&apos;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>]})

In [<span class="hljs-number">53</span>]: pd.merge(left, right, on=[<span class="hljs-string">&apos;key1&apos;</span>, <span class="hljs-string">&apos;key2&apos;</span>], how=<span class="hljs-string">&apos;outer&apos;</span>)
Out[<span class="hljs-number">53</span>]: 
  key1 key2  lval  rval
<span class="hljs-number">0</span>  foo  one   <span class="hljs-number">1.0</span>   <span class="hljs-number">4.0</span>
<span class="hljs-number">1</span>  foo  one   <span class="hljs-number">1.0</span>   <span class="hljs-number">5.0</span>
<span class="hljs-number">2</span>  foo  two   <span class="hljs-number">2.0</span>   NaN
<span class="hljs-number">3</span>  bar  one   <span class="hljs-number">3.0</span>   <span class="hljs-number">6.0</span>
<span class="hljs-number">4</span>  bar  two   NaN   <span class="hljs-number">7.0</span>
</code></pre>
<p>&#x7ED3;&#x679C;&#x4E2D;&#x4F1A;&#x51FA;&#x73B0;&#x54EA;&#x4E9B;&#x952E;&#x7EC4;&#x5408;&#x53D6;&#x51B3;&#x4E8E;&#x6240;&#x9009;&#x7684;&#x5408;&#x5E76;&#x65B9;&#x5F0F;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x6765;&#x7406;&#x89E3;&#xFF1A;&#x591A;&#x4E2A;&#x952E;&#x5F62;&#x6210;&#x4E00;&#x7CFB;&#x5217;&#x5143;&#x7EC4;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x5F53;&#x505A;&#x5355;&#x4E2A;&#x8FDE;&#x63A5;&#x952E;&#xFF08;&#x5F53;&#x7136;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5E76;&#x4E0D;&#x662F;&#x8FD9;&#x4E48;&#x56DE;&#x4E8B;&#xFF09;&#x3002;</p>
<blockquote>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x5728;&#x8FDB;&#x884C;&#x5217;&#xFF0D;&#x5217;&#x8FDE;&#x63A5;&#x65F6;&#xFF0C;DataFrame&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x7D22;&#x5F15;&#x4F1A;&#x88AB;&#x4E22;&#x5F03;&#x3002;</p>
</blockquote>
<p>&#x5BF9;&#x4E8E;&#x5408;&#x5E76;&#x8FD0;&#x7B97;&#x9700;&#x8981;&#x8003;&#x8651;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#x5BF9;&#x91CD;&#x590D;&#x5217;&#x540D;&#x7684;&#x5904;&#x7406;&#x3002;&#x867D;&#x7136;&#x4F60;&#x53EF;&#x4EE5;&#x624B;&#x5DE5;&#x5904;&#x7406;&#x5217;&#x540D;&#x91CD;&#x53E0;&#x7684;&#x95EE;&#x9898;&#xFF08;&#x67E5;&#x770B;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x91CD;&#x547D;&#x540D;&#x8F74;&#x6807;&#x7B7E;&#xFF09;&#xFF0C;&#x4F46;merge&#x6709;&#x4E00;&#x4E2A;&#x66F4;&#x5B9E;&#x7528;&#x7684;suffixes&#x9009;&#x9879;&#xFF0C;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x9644;&#x52A0;&#x5230;&#x5DE6;&#x53F3;&#x4E24;&#x4E2A;DataFrame&#x5BF9;&#x8C61;&#x7684;&#x91CD;&#x53E0;&#x5217;&#x540D;&#x4E0A;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">54</span>]: pd.merge(left, right, on=<span class="hljs-string">&apos;key1&apos;</span>)
Out[<span class="hljs-number">54</span>]: 
  key1 key2_x  lval key2_y  rval
<span class="hljs-number">0</span>  foo    one     <span class="hljs-number">1</span>    one     <span class="hljs-number">4</span>
<span class="hljs-number">1</span>  foo    one     <span class="hljs-number">1</span>    one     <span class="hljs-number">5</span>
<span class="hljs-number">2</span>  foo    two     <span class="hljs-number">2</span>    one     <span class="hljs-number">4</span>
<span class="hljs-number">3</span>  foo    two     <span class="hljs-number">2</span>    one     <span class="hljs-number">5</span>
<span class="hljs-number">4</span>  bar    one     <span class="hljs-number">3</span>    one     <span class="hljs-number">6</span>
<span class="hljs-number">5</span>  bar    one     <span class="hljs-number">3</span>    two     <span class="hljs-number">7</span>

In [<span class="hljs-number">55</span>]: pd.merge(left, right, on=<span class="hljs-string">&apos;key1&apos;</span>, suffixes=(<span class="hljs-string">&apos;_left&apos;</span>, <span class="hljs-string">&apos;_right&apos;</span>))
Out[<span class="hljs-number">55</span>]: 
  key1 key2_left  lval key2_right  rval
<span class="hljs-number">0</span>  foo       one     <span class="hljs-number">1</span>        one     <span class="hljs-number">4</span>
<span class="hljs-number">1</span>  foo       one     <span class="hljs-number">1</span>        one     <span class="hljs-number">5</span>
<span class="hljs-number">2</span>  foo       two     <span class="hljs-number">2</span>        one     <span class="hljs-number">4</span>
<span class="hljs-number">3</span>  foo       two     <span class="hljs-number">2</span>        one     <span class="hljs-number">5</span>
<span class="hljs-number">4</span>  bar       one     <span class="hljs-number">3</span>        one     <span class="hljs-number">6</span>
<span class="hljs-number">5</span>  bar       one     <span class="hljs-number">3</span>        two     <span class="hljs-number">7</span>
</code></pre>
<p>merge&#x7684;&#x53C2;&#x6570;&#x8BF7;&#x53C2;&#x89C1;&#x8868;8-2&#x3002;&#x4F7F;&#x7528;DataFrame&#x7684;&#x884C;&#x7D22;&#x5F15;&#x5408;&#x5E76;&#x662F;&#x4E0B;&#x4E00;&#x8282;&#x7684;&#x4E3B;&#x9898;&#x3002;</p>
<p>&#x8868;8-2 merge&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-35ca716a4f1b8475.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-c86672e733ceccd9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>indicator &#x6DFB;&#x52A0;&#x7279;&#x6B8A;&#x7684;&#x5217;_merge&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x6307;&#x660E;&#x6BCF;&#x4E2A;&#x884C;&#x7684;&#x6765;&#x6E90;&#xFF0C;&#x5B83;&#x7684;&#x503C;&#x6709;left_only&#x3001;right_only&#x6216;both&#xFF0C;&#x6839;&#x636E;&#x6BCF;&#x884C;&#x7684;&#x5408;&#x5E76;&#x6570;&#x636E;&#x7684;&#x6765;&#x6E90;&#x3002;</p>
<h2 id="&#x7D22;&#x5F15;&#x4E0A;&#x7684;&#x5408;&#x5E76;">&#x7D22;&#x5F15;&#x4E0A;&#x7684;&#x5408;&#x5E76;</h2>
<p>&#x6709;&#x65F6;&#x5019;&#xFF0C;DataFrame&#x4E2D;&#x7684;&#x8FDE;&#x63A5;&#x952E;&#x4F4D;&#x4E8E;&#x5176;&#x7D22;&#x5F15;&#x4E2D;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F20;&#x5165;left_index=True&#x6216;right_index=True&#xFF08;&#x6216;&#x4E24;&#x4E2A;&#x90FD;&#x4F20;&#xFF09;&#x4EE5;&#x8BF4;&#x660E;&#x7D22;&#x5F15;&#x5E94;&#x8BE5;&#x88AB;&#x7528;&#x4F5C;&#x8FDE;&#x63A5;&#x952E;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">56</span>]: left1 = pd.DataFrame({<span class="hljs-string">&apos;key&apos;</span>: [<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>],
   ....:                       <span class="hljs-string">&apos;value&apos;</span>: range(<span class="hljs-number">6</span>)})

In [<span class="hljs-number">57</span>]: right1 = pd.DataFrame({<span class="hljs-string">&apos;group_val&apos;</span>: [<span class="hljs-number">3.5</span>, <span class="hljs-number">7</span>]}, index=[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>])

In [<span class="hljs-number">58</span>]: left1
Out[<span class="hljs-number">58</span>]:

  key  value
<span class="hljs-number">0</span>   a      <span class="hljs-number">0</span>
<span class="hljs-number">1</span>   b      <span class="hljs-number">1</span>
<span class="hljs-number">2</span>   a      <span class="hljs-number">2</span>
<span class="hljs-number">3</span>   a      <span class="hljs-number">3</span>
<span class="hljs-number">4</span>   b      <span class="hljs-number">4</span>
<span class="hljs-number">5</span>   c      <span class="hljs-number">5</span>

In [<span class="hljs-number">59</span>]: right1
Out[<span class="hljs-number">59</span>]: 
   group_val
a        <span class="hljs-number">3.5</span>
b        <span class="hljs-number">7.0</span>

In [<span class="hljs-number">60</span>]: pd.merge(left1, right1, left_on=<span class="hljs-string">&apos;key&apos;</span>, right_index=<span class="hljs-keyword">True</span>)
Out[<span class="hljs-number">60</span>]: 
  key  value  group_val
<span class="hljs-number">0</span>   a      <span class="hljs-number">0</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">2</span>   a      <span class="hljs-number">2</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">3</span>   a      <span class="hljs-number">3</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">1</span>   b      <span class="hljs-number">1</span>        <span class="hljs-number">7.0</span>
<span class="hljs-number">4</span>   b      <span class="hljs-number">4</span>        <span class="hljs-number">7.0</span>
</code></pre>
<p>&#x7531;&#x4E8E;&#x9ED8;&#x8BA4;&#x7684;merge&#x65B9;&#x6CD5;&#x662F;&#x6C42;&#x53D6;&#x8FDE;&#x63A5;&#x952E;&#x7684;&#x4EA4;&#x96C6;&#xFF0C;&#x56E0;&#x6B64;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5916;&#x8FDE;&#x63A5;&#x7684;&#x65B9;&#x5F0F;&#x5F97;&#x5230;&#x5B83;&#x4EEC;&#x7684;&#x5E76;&#x96C6;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">61</span>]: pd.merge(left1, right1, left_on=<span class="hljs-string">&apos;key&apos;</span>, right_index=<span class="hljs-keyword">True</span>, how=<span class="hljs-string">&apos;outer&apos;</span>)
Out[<span class="hljs-number">61</span>]: 
  key  value  group_val
<span class="hljs-number">0</span>   a      <span class="hljs-number">0</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">2</span>   a      <span class="hljs-number">2</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">3</span>   a      <span class="hljs-number">3</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">1</span>   b      <span class="hljs-number">1</span>        <span class="hljs-number">7.0</span>
<span class="hljs-number">4</span>   b      <span class="hljs-number">4</span>        <span class="hljs-number">7.0</span>
<span class="hljs-number">5</span>   c      <span class="hljs-number">5</span>        NaN
</code></pre>
<p>&#x5BF9;&#x4E8E;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4E8B;&#x60C5;&#x5C31;&#x6709;&#x70B9;&#x590D;&#x6742;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x7D22;&#x5F15;&#x7684;&#x5408;&#x5E76;&#x9ED8;&#x8BA4;&#x662F;&#x591A;&#x952E;&#x5408;&#x5E76;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">62</span>]: lefth = pd.DataFrame({<span class="hljs-string">&apos;key1&apos;</span>: [<span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Ohio&apos;</span>,
   ....:                                <span class="hljs-string">&apos;Nevada&apos;</span>, <span class="hljs-string">&apos;Nevada&apos;</span>],
   ....:                       <span class="hljs-string">&apos;key2&apos;</span>: [<span class="hljs-number">2000</span>, <span class="hljs-number">2001</span>, <span class="hljs-number">2002</span>, <span class="hljs-number">2001</span>, <span class="hljs-number">2002</span>],
   ....:                       <span class="hljs-string">&apos;data&apos;</span>: np.arange(<span class="hljs-number">5.</span>)})

In [<span class="hljs-number">63</span>]: righth = pd.DataFrame(np.arange(<span class="hljs-number">12</span>).reshape((<span class="hljs-number">6</span>, <span class="hljs-number">2</span>)),
   ....:                       index=[[<span class="hljs-string">&apos;Nevada&apos;</span>, <span class="hljs-string">&apos;Nevada&apos;</span>, <span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Ohio&apos;</span>,
   ....:                               <span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Ohio&apos;</span>],
   ....:                              [<span class="hljs-number">2001</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">2001</span>, <span class="hljs-number">2002</span>]],
   ....:                       columns=[<span class="hljs-string">&apos;event1&apos;</span>, <span class="hljs-string">&apos;event2&apos;</span>])

In [<span class="hljs-number">64</span>]: lefth
Out[<span class="hljs-number">64</span>]: 
   data    key1  key2
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>    Ohio  <span class="hljs-number">2000</span>
<span class="hljs-number">1</span>   <span class="hljs-number">1.0</span>    Ohio  <span class="hljs-number">2001</span>
<span class="hljs-number">2</span>   <span class="hljs-number">2.0</span>    Ohio  <span class="hljs-number">2002</span>
<span class="hljs-number">3</span>   <span class="hljs-number">3.0</span>  Nevada  <span class="hljs-number">2001</span>
<span class="hljs-number">4</span>   <span class="hljs-number">4.0</span>  Nevada  <span class="hljs-number">2002</span>

In [<span class="hljs-number">65</span>]: righth
Out[<span class="hljs-number">65</span>]: 
             event1  event2
Nevada <span class="hljs-number">2001</span>       <span class="hljs-number">0</span>       <span class="hljs-number">1</span>
       <span class="hljs-number">2000</span>       <span class="hljs-number">2</span>       <span class="hljs-number">3</span>
Ohio   <span class="hljs-number">2000</span>       <span class="hljs-number">4</span>       <span class="hljs-number">5</span>
       <span class="hljs-number">2000</span>       <span class="hljs-number">6</span>       <span class="hljs-number">7</span>
       <span class="hljs-number">2001</span>       <span class="hljs-number">8</span>       <span class="hljs-number">9</span>
       <span class="hljs-number">2002</span>      <span class="hljs-number">10</span>      <span class="hljs-number">11</span>
</code></pre>
<p>&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x4EE5;&#x5217;&#x8868;&#x7684;&#x5F62;&#x5F0F;&#x6307;&#x660E;&#x7528;&#x4F5C;&#x5408;&#x5E76;&#x952E;&#x7684;&#x591A;&#x4E2A;&#x5217;&#xFF08;&#x6CE8;&#x610F;&#x7528;how=&apos;outer&apos;&#x5BF9;&#x91CD;&#x590D;&#x7D22;&#x5F15;&#x503C;&#x7684;&#x5904;&#x7406;&#xFF09;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">66</span>]: pd.merge(lefth, righth, left_on=[<span class="hljs-string">&apos;key1&apos;</span>, <span class="hljs-string">&apos;key2&apos;</span>], right_index=<span class="hljs-keyword">True</span>)
Out[<span class="hljs-number">66</span>]: 
   data    key1  key2  event1  event2
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>    Ohio  <span class="hljs-number">2000</span>       <span class="hljs-number">4</span>       <span class="hljs-number">5</span>
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>    Ohio  <span class="hljs-number">2000</span>       <span class="hljs-number">6</span>       <span class="hljs-number">7</span>
<span class="hljs-number">1</span>   <span class="hljs-number">1.0</span>    Ohio  <span class="hljs-number">2001</span>       <span class="hljs-number">8</span>       <span class="hljs-number">9</span>
<span class="hljs-number">2</span>   <span class="hljs-number">2.0</span>    Ohio  <span class="hljs-number">2002</span>      <span class="hljs-number">10</span>      <span class="hljs-number">11</span>
<span class="hljs-number">3</span>   <span class="hljs-number">3.0</span>  Nevada  <span class="hljs-number">2001</span>       <span class="hljs-number">0</span>       <span class="hljs-number">1</span>

In [<span class="hljs-number">67</span>]: pd.merge(lefth, righth, left_on=[<span class="hljs-string">&apos;key1&apos;</span>, <span class="hljs-string">&apos;key2&apos;</span>],
   ....:          right_index=<span class="hljs-keyword">True</span>, how=<span class="hljs-string">&apos;outer&apos;</span>)
Out[<span class="hljs-number">67</span>]: 
   data    key1  key2  event1  event2
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>    Ohio  <span class="hljs-number">2000</span>     <span class="hljs-number">4.0</span>     <span class="hljs-number">5.0</span>
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>    Ohio  <span class="hljs-number">2000</span>     <span class="hljs-number">6.0</span>     <span class="hljs-number">7.0</span>
<span class="hljs-number">1</span>   <span class="hljs-number">1.0</span>    Ohio  <span class="hljs-number">2001</span>     <span class="hljs-number">8.0</span>     <span class="hljs-number">9.0</span>
<span class="hljs-number">2</span>   <span class="hljs-number">2.0</span>    Ohio  <span class="hljs-number">2002</span>    <span class="hljs-number">10.0</span>    <span class="hljs-number">11.0</span>
<span class="hljs-number">3</span>   <span class="hljs-number">3.0</span>  Nevada  <span class="hljs-number">2001</span>     <span class="hljs-number">0.0</span>     <span class="hljs-number">1.0</span>
<span class="hljs-number">4</span>   <span class="hljs-number">4.0</span>  Nevada  <span class="hljs-number">2002</span>     NaN     NaN
<span class="hljs-number">4</span>   NaN  Nevada  <span class="hljs-number">2000</span>     <span class="hljs-number">2.0</span>     <span class="hljs-number">3.0</span>
</code></pre>
<p>&#x540C;&#x65F6;&#x4F7F;&#x7528;&#x5408;&#x5E76;&#x53CC;&#x65B9;&#x7684;&#x7D22;&#x5F15;&#x4E5F;&#x6CA1;&#x95EE;&#x9898;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">68</span>]: left2 = pd.DataFrame([[<span class="hljs-number">1.</span>, <span class="hljs-number">2.</span>], [<span class="hljs-number">3.</span>, <span class="hljs-number">4.</span>], [<span class="hljs-number">5.</span>, <span class="hljs-number">6.</span>]],
   ....:                      index=[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;e&apos;</span>],
   ....:                      columns=[<span class="hljs-string">&apos;Ohio&apos;</span>, <span class="hljs-string">&apos;Nevada&apos;</span>])

In [<span class="hljs-number">69</span>]: right2 = pd.DataFrame([[<span class="hljs-number">7.</span>, <span class="hljs-number">8.</span>], [<span class="hljs-number">9.</span>, <span class="hljs-number">10.</span>], [<span class="hljs-number">11.</span>, <span class="hljs-number">12.</span>], [<span class="hljs-number">13</span>, <span class="hljs-number">14</span>]],
   ....:                       index=[<span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>, <span class="hljs-string">&apos;e&apos;</span>],
   ....:                       columns=[<span class="hljs-string">&apos;Missouri&apos;</span>, <span class="hljs-string">&apos;Alabama&apos;</span>])

In [<span class="hljs-number">70</span>]: left2
Out[<span class="hljs-number">70</span>]: 
   Ohio  Nevada
a   <span class="hljs-number">1.0</span>     <span class="hljs-number">2.0</span>
c   <span class="hljs-number">3.0</span>     <span class="hljs-number">4.0</span>
e   <span class="hljs-number">5.0</span>     <span class="hljs-number">6.0</span>

In [<span class="hljs-number">71</span>]: right2
Out[<span class="hljs-number">71</span>]: 
   Missouri  Alabama
b       <span class="hljs-number">7.0</span>      <span class="hljs-number">8.0</span>
c       <span class="hljs-number">9.0</span>     <span class="hljs-number">10.0</span>
d      <span class="hljs-number">11.0</span>     <span class="hljs-number">12.0</span>
e      <span class="hljs-number">13.0</span>     <span class="hljs-number">14.0</span>

In [<span class="hljs-number">72</span>]: pd.merge(left2, right2, how=<span class="hljs-string">&apos;outer&apos;</span>, left_index=<span class="hljs-keyword">True</span>, right_index=<span class="hljs-keyword">True</span>)
Out[<span class="hljs-number">72</span>]: 
   Ohio  Nevada  Missouri  Alabama
a   <span class="hljs-number">1.0</span>     <span class="hljs-number">2.0</span>       NaN      NaN
b   NaN     NaN       <span class="hljs-number">7.0</span>      <span class="hljs-number">8.0</span>
c   <span class="hljs-number">3.0</span>     <span class="hljs-number">4.0</span>       <span class="hljs-number">9.0</span>     <span class="hljs-number">10.0</span>
d   NaN     NaN      <span class="hljs-number">11.0</span>     <span class="hljs-number">12.0</span>
e   <span class="hljs-number">5.0</span>     <span class="hljs-number">6.0</span>      <span class="hljs-number">13.0</span>     <span class="hljs-number">14.0</span>
</code></pre>
<p>DataFrame&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x4FBF;&#x6377;&#x7684;join&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x80FD;&#x66F4;&#x4E3A;&#x65B9;&#x4FBF;&#x5730;&#x5B9E;&#x73B0;&#x6309;&#x7D22;&#x5F15;&#x5408;&#x5E76;&#x3002;&#x5B83;&#x8FD8;&#x53EF;&#x7528;&#x4E8E;&#x5408;&#x5E76;&#x591A;&#x4E2A;&#x5E26;&#x6709;&#x76F8;&#x540C;&#x6216;&#x76F8;&#x4F3C;&#x7D22;&#x5F15;&#x7684;DataFrame&#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x8981;&#x6C42;&#x6CA1;&#x6709;&#x91CD;&#x53E0;&#x7684;&#x5217;&#x3002;&#x5728;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">73</span>]: left2.join(right2, how=<span class="hljs-string">&apos;outer&apos;</span>)
Out[<span class="hljs-number">73</span>]: 
   Ohio  Nevada  Missouri  Alabama
a   <span class="hljs-number">1.0</span>     <span class="hljs-number">2.0</span>       NaN      NaN
b   NaN     NaN       <span class="hljs-number">7.0</span>      <span class="hljs-number">8.0</span>
c   <span class="hljs-number">3.0</span>     <span class="hljs-number">4.0</span>       <span class="hljs-number">9.0</span>     <span class="hljs-number">10.0</span>
d   NaN     NaN      <span class="hljs-number">11.0</span>     <span class="hljs-number">12.0</span>
e   <span class="hljs-number">5.0</span>     <span class="hljs-number">6.0</span>      <span class="hljs-number">13.0</span>     <span class="hljs-number">14.0</span>
</code></pre>
<p>&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;&#x5386;&#x53F2;&#x7248;&#x672C;&#x7684;&#x9057;&#x7559;&#x539F;&#x56E0;&#xFF0C;DataFrame&#x7684;join&#x65B9;&#x6CD5;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x5DE6;&#x8FDE;&#x63A5;&#xFF0C;&#x4FDD;&#x7559;&#x5DE6;&#x8FB9;&#x8868;&#x7684;&#x884C;&#x7D22;&#x5F15;&#x3002;&#x5B83;&#x8FD8;&#x652F;&#x6301;&#x5728;&#x8C03;&#x7528;&#x7684;DataFrame&#x7684;&#x5217;&#x4E0A;&#xFF0C;&#x8FDE;&#x63A5;&#x4F20;&#x9012;&#x7684;DataFrame&#x7D22;&#x5F15;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">74</span>]: left1.join(right1, on=<span class="hljs-string">&apos;key&apos;</span>)
Out[<span class="hljs-number">74</span>]: 
  key  value  group_val
<span class="hljs-number">0</span>   a      <span class="hljs-number">0</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">1</span>   b      <span class="hljs-number">1</span>        <span class="hljs-number">7.0</span>
<span class="hljs-number">2</span>   a      <span class="hljs-number">2</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">3</span>   a      <span class="hljs-number">3</span>        <span class="hljs-number">3.5</span>
<span class="hljs-number">4</span>   b      <span class="hljs-number">4</span>        <span class="hljs-number">7.0</span>
<span class="hljs-number">5</span>   c      <span class="hljs-number">5</span>        NaN
</code></pre>
<p>&#x6700;&#x540E;&#xFF0C;&#x5BF9;&#x4E8E;&#x7B80;&#x5355;&#x7684;&#x7D22;&#x5F15;&#x5408;&#x5E76;&#xFF0C;&#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x5411;join&#x4F20;&#x5165;&#x4E00;&#x7EC4;DataFrame&#xFF0C;&#x4E0B;&#x4E00;&#x8282;&#x4F1A;&#x4ECB;&#x7ECD;&#x66F4;&#x4E3A;&#x901A;&#x7528;&#x7684;concat&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x80FD;&#x5B9E;&#x73B0;&#x6B64;&#x529F;&#x80FD;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">75</span>]: another = pd.DataFrame([[<span class="hljs-number">7.</span>, <span class="hljs-number">8.</span>], [<span class="hljs-number">9.</span>, <span class="hljs-number">10.</span>], [<span class="hljs-number">11.</span>, <span class="hljs-number">12.</span>], [<span class="hljs-number">16.</span>, <span class="hljs-number">17.</span>]],
   ....:                        index=[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;e&apos;</span>, <span class="hljs-string">&apos;f&apos;</span>],
   ....:                        columns=[<span class="hljs-string">&apos;New York&apos;</span>,
<span class="hljs-string">&apos;Oregon&apos;</span>])

In [<span class="hljs-number">76</span>]: another
Out[<span class="hljs-number">76</span>]: 
   New York  Oregon
a       <span class="hljs-number">7.0</span>     <span class="hljs-number">8.0</span>
c       <span class="hljs-number">9.0</span>    <span class="hljs-number">10.0</span>
e      <span class="hljs-number">11.0</span>    <span class="hljs-number">12.0</span>
f      <span class="hljs-number">16.0</span>    <span class="hljs-number">17.0</span>

In [<span class="hljs-number">77</span>]: left2.join([right2, another])
Out[<span class="hljs-number">77</span>]: 
   Ohio  Nevada  Missouri  Alabama  New York  Oregon
a   <span class="hljs-number">1.0</span>     <span class="hljs-number">2.0</span>       NaN      NaN       <span class="hljs-number">7.0</span>     <span class="hljs-number">8.0</span>
c   <span class="hljs-number">3.0</span>     <span class="hljs-number">4.0</span>       <span class="hljs-number">9.0</span>     <span class="hljs-number">10.0</span>       <span class="hljs-number">9.0</span>    <span class="hljs-number">10.0</span>
e   <span class="hljs-number">5.0</span>     <span class="hljs-number">6.0</span>      <span class="hljs-number">13.0</span>     <span class="hljs-number">14.0</span>      <span class="hljs-number">11.0</span>    <span class="hljs-number">12.0</span>

In [<span class="hljs-number">78</span>]: left2.join([right2, another], how=<span class="hljs-string">&apos;outer&apos;</span>)
Out[<span class="hljs-number">78</span>]: 
   Ohio  Nevada  Missouri  Alabama  New York  Oregon
a   <span class="hljs-number">1.0</span>     <span class="hljs-number">2.0</span>       NaN      NaN       <span class="hljs-number">7.0</span>     <span class="hljs-number">8.0</span>
b   NaN     NaN       <span class="hljs-number">7.0</span>      <span class="hljs-number">8.0</span>       NaN     NaN
c   <span class="hljs-number">3.0</span>     <span class="hljs-number">4.0</span>       <span class="hljs-number">9.0</span>     <span class="hljs-number">10.0</span>       <span class="hljs-number">9.0</span>    <span class="hljs-number">10.0</span>
d   NaN     NaN      <span class="hljs-number">11.0</span>     <span class="hljs-number">12.0</span>       NaN     NaN
e   <span class="hljs-number">5.0</span>     <span class="hljs-number">6.0</span>      <span class="hljs-number">13.0</span>     <span class="hljs-number">14.0</span>      <span class="hljs-number">11.0</span>    <span class="hljs-number">12.0</span>
f   NaN     NaN       NaN      NaN      <span class="hljs-number">16.0</span>    <span class="hljs-number">17.0</span>
</code></pre>
<h2 id="&#x8F74;&#x5411;&#x8FDE;&#x63A5;">&#x8F74;&#x5411;&#x8FDE;&#x63A5;</h2>
<p>&#x53E6;&#x4E00;&#x79CD;&#x6570;&#x636E;&#x5408;&#x5E76;&#x8FD0;&#x7B97;&#x4E5F;&#x88AB;&#x79F0;&#x4F5C;&#x8FDE;&#x63A5;&#xFF08;concatenation&#xFF09;&#x3001;&#x7ED1;&#x5B9A;&#xFF08;binding&#xFF09;&#x6216;&#x5806;&#x53E0;&#xFF08;stacking&#xFF09;&#x3002;NumPy&#x7684;concatenation&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x7528;NumPy&#x6570;&#x7EC4;&#x6765;&#x505A;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">79</span>]: arr = np.arange(<span class="hljs-number">12</span>).reshape((<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))

In [<span class="hljs-number">80</span>]: arr
Out[<span class="hljs-number">80</span>]: 
array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
       [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>],
       [ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>]])

In [<span class="hljs-number">81</span>]: np.concatenate([arr, arr], axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">81</span>]: 
array([[ <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>],
       [ <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>],
       [ <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>]])
</code></pre>
<p>&#x5BF9;&#x4E8E;pandas&#x5BF9;&#x8C61;&#xFF08;&#x5982;Series&#x548C;DataFrame&#xFF09;&#xFF0C;&#x5E26;&#x6709;&#x6807;&#x7B7E;&#x7684;&#x8F74;&#x4F7F;&#x4F60;&#x80FD;&#x591F;&#x8FDB;&#x4E00;&#x6B65;&#x63A8;&#x5E7F;&#x6570;&#x7EC4;&#x7684;&#x8FDE;&#x63A5;&#x8FD0;&#x7B97;&#x3002;&#x5177;&#x4F53;&#x70B9;&#x8BF4;&#xFF0C;&#x4F60;&#x8FD8;&#x9700;&#x8981;&#x8003;&#x8651;&#x4EE5;&#x4E0B;&#x8FD9;&#x4E9B;&#x4E1C;&#x897F;&#xFF1A;</p>
<ul>
<li>&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x5728;&#x5176;&#x5B83;&#x8F74;&#x4E0A;&#x7684;&#x7D22;&#x5F15;&#x4E0D;&#x540C;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x5408;&#x5E76;&#x8FD9;&#x4E9B;&#x8F74;&#x7684;&#x4E0D;&#x540C;&#x5143;&#x7D20;&#x8FD8;&#x662F;&#x53EA;&#x4F7F;&#x7528;&#x4EA4;&#x96C6;&#xFF1F;</li>
<li>&#x8FDE;&#x63A5;&#x7684;&#x6570;&#x636E;&#x96C6;&#x662F;&#x5426;&#x9700;&#x8981;&#x5728;&#x7ED3;&#x679C;&#x5BF9;&#x8C61;&#x4E2D;&#x53EF;&#x8BC6;&#x522B;&#xFF1F;</li>
<li>&#x8FDE;&#x63A5;&#x8F74;&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x6570;&#x636E;&#x662F;&#x5426;&#x9700;&#x8981;&#x4FDD;&#x7559;&#xFF1F;&#x8BB8;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;DataFrame&#x9ED8;&#x8BA4;&#x7684;&#x6574;&#x6570;&#x6807;&#x7B7E;&#x6700;&#x597D;&#x5728;&#x8FDE;&#x63A5;&#x65F6;&#x5220;&#x6389;&#x3002;</li>
</ul>
<p>pandas&#x7684;concat&#x51FD;&#x6570;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x80FD;&#x591F;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x7684;&#x53EF;&#x9760;&#x65B9;&#x5F0F;&#x3002;&#x6211;&#x5C06;&#x7ED9;&#x51FA;&#x4E00;&#x4E9B;&#x4F8B;&#x5B50;&#x6765;&#x8BB2;&#x89E3;&#x5176;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x3002;&#x5047;&#x8BBE;&#x6709;&#x4E09;&#x4E2A;&#x6CA1;&#x6709;&#x91CD;&#x53E0;&#x7D22;&#x5F15;&#x7684;Series&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">82</span>]: s1 = pd.Series([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], index=[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>])

In [<span class="hljs-number">83</span>]: s2 = pd.Series([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>], index=[<span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>, <span class="hljs-string">&apos;e&apos;</span>])

In [<span class="hljs-number">84</span>]: s3 = pd.Series([<span class="hljs-number">5</span>, <span class="hljs-number">6</span>], index=[<span class="hljs-string">&apos;f&apos;</span>, <span class="hljs-string">&apos;g&apos;</span>])
</code></pre>
<p>&#x5BF9;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x8C03;&#x7528;concat&#x53EF;&#x4EE5;&#x5C06;&#x503C;&#x548C;&#x7D22;&#x5F15;&#x7C98;&#x5408;&#x5728;&#x4E00;&#x8D77;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">85</span>]: pd.concat([s1, s2, s3])
Out[<span class="hljs-number">85</span>]: 
a    <span class="hljs-number">0</span>
b    <span class="hljs-number">1</span>
c    <span class="hljs-number">2</span>
d    <span class="hljs-number">3</span>
e    <span class="hljs-number">4</span>
f    <span class="hljs-number">5</span>
g    <span class="hljs-number">6</span>
dtype: int64
</code></pre>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;concat&#x662F;&#x5728;axis=0&#x4E0A;&#x5DE5;&#x4F5C;&#x7684;&#xFF0C;&#x6700;&#x7EC8;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x65B0;&#x7684;Series&#x3002;&#x5982;&#x679C;&#x4F20;&#x5165;axis=1&#xFF0C;&#x5219;&#x7ED3;&#x679C;&#x5C31;&#x4F1A;&#x53D8;&#x6210;&#x4E00;&#x4E2A;DataFrame&#xFF08;axis=1&#x662F;&#x5217;&#xFF09;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">86</span>]: pd.concat([s1, s2, s3], axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">86</span>]: 
     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>
a  <span class="hljs-number">0.0</span>  NaN  NaN
b  <span class="hljs-number">1.0</span>  NaN  NaN
c  NaN  <span class="hljs-number">2.0</span>  NaN
d  NaN  <span class="hljs-number">3.0</span>  NaN
e  NaN  <span class="hljs-number">4.0</span>  NaN
f  NaN  NaN  <span class="hljs-number">5.0</span>
g  NaN  NaN  <span class="hljs-number">6.0</span>
</code></pre>
<p>&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53E6;&#x5916;&#x7684;&#x8F74;&#x4E0A;&#x6CA1;&#x6709;&#x91CD;&#x53E0;&#xFF0C;&#x4ECE;&#x7D22;&#x5F15;&#x7684;&#x6709;&#x5E8F;&#x5E76;&#x96C6;&#xFF08;&#x5916;&#x8FDE;&#x63A5;&#xFF09;&#x4E0A;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6765;&#x3002;&#x4F20;&#x5165;join=&apos;inner&apos;&#x5373;&#x53EF;&#x5F97;&#x5230;&#x5B83;&#x4EEC;&#x7684;&#x4EA4;&#x96C6;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">87</span>]: s4 = pd.concat([s1, s3])

In [<span class="hljs-number">88</span>]: s4
Out[<span class="hljs-number">88</span>]: 
a    <span class="hljs-number">0</span>
b    <span class="hljs-number">1</span>
f    <span class="hljs-number">5</span>
g    <span class="hljs-number">6</span>
dtype: int64

In [<span class="hljs-number">89</span>]: pd.concat([s1, s4], axis=<span class="hljs-number">1</span>)
Out[<span class="hljs-number">89</span>]: 
     <span class="hljs-number">0</span>  <span class="hljs-number">1</span>
a  <span class="hljs-number">0.0</span>  <span class="hljs-number">0</span>
b  <span class="hljs-number">1.0</span>  <span class="hljs-number">1</span>
f  NaN  <span class="hljs-number">5</span>
g  NaN  <span class="hljs-number">6</span>

In [<span class="hljs-number">90</span>]: pd.concat([s1, s4], axis=<span class="hljs-number">1</span>, join=<span class="hljs-string">&apos;inner&apos;</span>)
Out[<span class="hljs-number">90</span>]: 
   <span class="hljs-number">0</span>  <span class="hljs-number">1</span>
a  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>
b  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
</code></pre>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;f&#x548C;g&#x6807;&#x7B7E;&#x6D88;&#x5931;&#x4E86;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x4F7F;&#x7528;&#x7684;&#x662F;join=&apos;inner&apos;&#x9009;&#x9879;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;join_axes&#x6307;&#x5B9A;&#x8981;&#x5728;&#x5176;&#x5B83;&#x8F74;&#x4E0A;&#x4F7F;&#x7528;&#x7684;&#x7D22;&#x5F15;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">91</span>]: pd.concat([s1, s4], axis=<span class="hljs-number">1</span>, join_axes=[[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;e&apos;</span>]])
Out[<span class="hljs-number">91</span>]: 
     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>
a  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>
c  NaN  NaN
b  <span class="hljs-number">1.0</span>  <span class="hljs-number">1.0</span>
e  NaN  NaN
</code></pre>
<p>&#x4E0D;&#x8FC7;&#x6709;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x53C2;&#x4E0E;&#x8FDE;&#x63A5;&#x7684;&#x7247;&#x6BB5;&#x5728;&#x7ED3;&#x679C;&#x4E2D;&#x533A;&#x5206;&#x4E0D;&#x5F00;&#x3002;&#x5047;&#x8BBE;&#x4F60;&#x60F3;&#x8981;&#x5728;&#x8FDE;&#x63A5;&#x8F74;&#x4E0A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#x3002;&#x4F7F;&#x7528;keys&#x53C2;&#x6570;&#x5373;&#x53EF;&#x8FBE;&#x5230;&#x8FD9;&#x4E2A;&#x76EE;&#x7684;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">92</span>]: result = pd.concat([s1, s1, s3], keys=[<span class="hljs-string">&apos;one&apos;</span>,<span class="hljs-string">&apos;two&apos;</span>, <span class="hljs-string">&apos;three&apos;</span>])

In [<span class="hljs-number">93</span>]: result
Out[<span class="hljs-number">93</span>]: 
one    a    <span class="hljs-number">0</span>
       b    <span class="hljs-number">1</span>
two    a    <span class="hljs-number">0</span>
       b    <span class="hljs-number">1</span>
three  f    <span class="hljs-number">5</span>
       g    <span class="hljs-number">6</span>
dtype: int64

In [<span class="hljs-number">94</span>]: result.unstack()
Out[<span class="hljs-number">94</span>]: 
         a    b    f    g
one    <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>  NaN  NaN
two    <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>  NaN  NaN
three  NaN  NaN  <span class="hljs-number">5.0</span>  <span class="hljs-number">6.0</span>
</code></pre>
<p>&#x5982;&#x679C;&#x6CBF;&#x7740;axis=1&#x5BF9;Series&#x8FDB;&#x884C;&#x5408;&#x5E76;&#xFF0C;&#x5219;keys&#x5C31;&#x4F1A;&#x6210;&#x4E3A;DataFrame&#x7684;&#x5217;&#x5934;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">95</span>]: pd.concat([s1, s2, s3], axis=<span class="hljs-number">1</span>, keys=[<span class="hljs-string">&apos;one&apos;</span>,<span class="hljs-string">&apos;two&apos;</span>, <span class="hljs-string">&apos;three&apos;</span>])
Out[<span class="hljs-number">95</span>]: 
   one  two  three
a  <span class="hljs-number">0.0</span>  NaN    NaN
b  <span class="hljs-number">1.0</span>  NaN    NaN
c  NaN  <span class="hljs-number">2.0</span>    NaN
d  NaN  <span class="hljs-number">3.0</span>    NaN
e  NaN  <span class="hljs-number">4.0</span>    NaN
f  NaN  NaN    <span class="hljs-number">5.0</span>
g  NaN  NaN    <span class="hljs-number">6.0</span>
</code></pre>
<p>&#x540C;&#x6837;&#x7684;&#x903B;&#x8F91;&#x4E5F;&#x9002;&#x7528;&#x4E8E;DataFrame&#x5BF9;&#x8C61;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">96</span>]: df1 = pd.DataFrame(np.arange(<span class="hljs-number">6</span>).reshape(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>), index=[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>],
   ....:                    columns=[<span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;two&apos;</span>])

In [<span class="hljs-number">97</span>]: df2 = pd.DataFrame(<span class="hljs-number">5</span> + np.arange(<span class="hljs-number">4</span>).reshape(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), index=[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>],
   ....:                    columns=[<span class="hljs-string">&apos;three&apos;</span>, <span class="hljs-string">&apos;four&apos;</span>])

In [<span class="hljs-number">98</span>]: df1
Out[<span class="hljs-number">98</span>]: 
   one  two
a    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>    <span class="hljs-number">3</span>
c    <span class="hljs-number">4</span>    <span class="hljs-number">5</span>

In [<span class="hljs-number">99</span>]: df2
Out[<span class="hljs-number">99</span>]: 
   three  four
a      <span class="hljs-number">5</span>     <span class="hljs-number">6</span>
c      <span class="hljs-number">7</span>     <span class="hljs-number">8</span>

In [<span class="hljs-number">100</span>]: pd.concat([df1, df2], axis=<span class="hljs-number">1</span>, keys=[<span class="hljs-string">&apos;level1&apos;</span>, <span class="hljs-string">&apos;level2&apos;</span>])
Out[<span class="hljs-number">100</span>]: 
  level1     level2     
     one two  three four
a      <span class="hljs-number">0</span>   <span class="hljs-number">1</span>    <span class="hljs-number">5.0</span>  <span class="hljs-number">6.0</span>
b      <span class="hljs-number">2</span>   <span class="hljs-number">3</span>    NaN  NaN
c      <span class="hljs-number">4</span>   <span class="hljs-number">5</span>    <span class="hljs-number">7.0</span>  <span class="hljs-number">8.0</span>
</code></pre>
<p>&#x5982;&#x679C;&#x4F20;&#x5165;&#x7684;&#x4E0D;&#x662F;&#x5217;&#x8868;&#x800C;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#xFF0C;&#x5219;&#x5B57;&#x5178;&#x7684;&#x952E;&#x5C31;&#x4F1A;&#x88AB;&#x5F53;&#x505A;keys&#x9009;&#x9879;&#x7684;&#x503C;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">101</span>]: pd.concat({<span class="hljs-string">&apos;level1&apos;</span>: df1, <span class="hljs-string">&apos;level2&apos;</span>: df2}, axis=<span class="hljs-number">1</span>)

Out[<span class="hljs-number">101</span>]: 
  level1     level2     
     one two  three four
a      <span class="hljs-number">0</span>   <span class="hljs-number">1</span>    <span class="hljs-number">5.0</span>  <span class="hljs-number">6.0</span>
b      <span class="hljs-number">2</span>   <span class="hljs-number">3</span>    NaN  NaN
c      <span class="hljs-number">4</span>   <span class="hljs-number">5</span>    <span class="hljs-number">7.0</span>  <span class="hljs-number">8.0</span>
</code></pre>
<p>&#x6B64;&#x5916;&#x8FD8;&#x6709;&#x4E24;&#x4E2A;&#x7528;&#x4E8E;&#x7BA1;&#x7406;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#x521B;&#x5EFA;&#x65B9;&#x5F0F;&#x7684;&#x53C2;&#x6570;&#xFF08;&#x53C2;&#x89C1;&#x8868;8-3&#xFF09;&#x3002;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;names&#x53C2;&#x6570;&#x547D;&#x540D;&#x521B;&#x5EFA;&#x7684;&#x8F74;&#x7EA7;&#x522B;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">102</span>]: pd.concat([df1, df2], axis=<span class="hljs-number">1</span>, keys=[<span class="hljs-string">&apos;level1&apos;</span>, <span class="hljs-string">&apos;level2&apos;</span>],
   .....:           names=[<span class="hljs-string">&apos;upper&apos;</span>, <span class="hljs-string">&apos;lower&apos;</span>])
Out[<span class="hljs-number">102</span>]: 
upper level1     level2     
lower    one two  three four
a          <span class="hljs-number">0</span>   <span class="hljs-number">1</span>    <span class="hljs-number">5.0</span>  <span class="hljs-number">6.0</span>
b          <span class="hljs-number">2</span>   <span class="hljs-number">3</span>    NaN  NaN
c          <span class="hljs-number">4</span>   <span class="hljs-number">5</span>    <span class="hljs-number">7.0</span>  <span class="hljs-number">8.0</span>
</code></pre>
<p>&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5173;&#x4E8E;DataFrame&#x7684;&#x95EE;&#x9898;&#x662F;&#xFF0C;DataFrame&#x7684;&#x884C;&#x7D22;&#x5F15;&#x4E0D;&#x5305;&#x542B;&#x4EFB;&#x4F55;&#x76F8;&#x5173;&#x6570;&#x636E;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">103</span>]: df1 = pd.DataFrame(np.random.randn(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>), columns=[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>])

In [<span class="hljs-number">104</span>]: df2 = pd.DataFrame(np.random.randn(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>), columns=[<span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>])

In [<span class="hljs-number">105</span>]: df1
Out[<span class="hljs-number">105</span>]: 
          a         b         c         d
<span class="hljs-number">0</span>  <span class="hljs-number">1.246435</span>  <span class="hljs-number">1.007189</span> <span class="hljs-number">-1.296221</span>  <span class="hljs-number">0.274992</span>
<span class="hljs-number">1</span>  <span class="hljs-number">0.228913</span>  <span class="hljs-number">1.352917</span>  <span class="hljs-number">0.886429</span> <span class="hljs-number">-2.001637</span>
<span class="hljs-number">2</span> <span class="hljs-number">-0.371843</span>  <span class="hljs-number">1.669025</span> <span class="hljs-number">-0.438570</span> <span class="hljs-number">-0.539741</span>

In [<span class="hljs-number">106</span>]: df2
Out[<span class="hljs-number">106</span>]: 
          b         d         a
<span class="hljs-number">0</span>  <span class="hljs-number">0.476985</span>  <span class="hljs-number">3.248944</span> <span class="hljs-number">-1.021228</span>
<span class="hljs-number">1</span> <span class="hljs-number">-0.577087</span>  <span class="hljs-number">0.124121</span>  <span class="hljs-number">0.302614</span>
</code></pre>
<p>&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F20;&#x5165;ignore_index=True&#x5373;&#x53EF;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">107</span>]: pd.concat([df1, df2], ignore_index=<span class="hljs-keyword">True</span>)
Out[<span class="hljs-number">107</span>]: 
          a         b         c         d
<span class="hljs-number">0</span>  <span class="hljs-number">1.246435</span>  <span class="hljs-number">1.007189</span> <span class="hljs-number">-1.296221</span>  <span class="hljs-number">0.274992</span>
<span class="hljs-number">1</span>  <span class="hljs-number">0.228913</span>  <span class="hljs-number">1.352917</span>  <span class="hljs-number">0.886429</span> <span class="hljs-number">-2.001637</span>
<span class="hljs-number">2</span> <span class="hljs-number">-0.371843</span>  <span class="hljs-number">1.669025</span> <span class="hljs-number">-0.438570</span> <span class="hljs-number">-0.539741</span>
<span class="hljs-number">3</span> <span class="hljs-number">-1.021228</span>  <span class="hljs-number">0.476985</span>       NaN  <span class="hljs-number">3.248944</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.302614</span> <span class="hljs-number">-0.577087</span>       NaN  <span class="hljs-number">0.124121</span>
</code></pre>
<p><img src="http://upload-images.jianshu.io/upload_images/7178691-339436563b519415.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x8868;8-3 concat&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;"></p>
<h2 id="&#x5408;&#x5E76;&#x91CD;&#x53E0;&#x6570;&#x636E;">&#x5408;&#x5E76;&#x91CD;&#x53E0;&#x6570;&#x636E;</h2>
<p>&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x6570;&#x636E;&#x7EC4;&#x5408;&#x95EE;&#x9898;&#x4E0D;&#x80FD;&#x7528;&#x7B80;&#x5355;&#x7684;&#x5408;&#x5E76;&#xFF08;merge&#xFF09;&#x6216;&#x8FDE;&#x63A5;&#xFF08;concatenation&#xFF09;&#x8FD0;&#x7B97;&#x6765;&#x5904;&#x7406;&#x3002;&#x6BD4;&#x5982;&#x8BF4;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x6709;&#x7D22;&#x5F15;&#x5168;&#x90E8;&#x6216;&#x90E8;&#x5206;&#x91CD;&#x53E0;&#x7684;&#x4E24;&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x3002;&#x4E3E;&#x4E2A;&#x6709;&#x542F;&#x53D1;&#x6027;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;NumPy&#x7684;where&#x51FD;&#x6570;&#xFF0C;&#x5B83;&#x8868;&#x793A;&#x4E00;&#x79CD;&#x7B49;&#x4EF7;&#x4E8E;&#x9762;&#x5411;&#x6570;&#x7EC4;&#x7684;if-else&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">108</span>]: a = pd.Series([np.nan, <span class="hljs-number">2.5</span>, np.nan, <span class="hljs-number">3.5</span>, <span class="hljs-number">4.5</span>, np.nan],
   .....:               index=[<span class="hljs-string">&apos;f&apos;</span>, <span class="hljs-string">&apos;e&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>])

In [<span class="hljs-number">109</span>]: b = pd.Series(np.arange(len(a), dtype=np.float64),
   .....:               index=[<span class="hljs-string">&apos;f&apos;</span>, <span class="hljs-string">&apos;e&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>])

In [<span class="hljs-number">110</span>]: b[<span class="hljs-number">-1</span>] = np.nan

In [<span class="hljs-number">111</span>]: a
Out[<span class="hljs-number">111</span>]: 
f    NaN
e    <span class="hljs-number">2.5</span>
d    NaN
c    <span class="hljs-number">3.5</span>
b    <span class="hljs-number">4.5</span>
a    NaN
dtype: float64

In [<span class="hljs-number">112</span>]: b
Out[<span class="hljs-number">112</span>]: 
f    <span class="hljs-number">0.0</span>
e    <span class="hljs-number">1.0</span>
d    <span class="hljs-number">2.0</span>
c    <span class="hljs-number">3.0</span>
b    <span class="hljs-number">4.0</span>
a    NaN
dtype: float64

In [<span class="hljs-number">113</span>]: np.where(pd.isnull(a), b, a)
Out[<span class="hljs-number">113</span>]: array([ <span class="hljs-number">0.</span> ,  <span class="hljs-number">2.5</span>,  <span class="hljs-number">2.</span> ,  <span class="hljs-number">3.5</span>,  <span class="hljs-number">4.5</span>,  nan])
</code></pre>
<p>Series&#x6709;&#x4E00;&#x4E2A;combine_first&#x65B9;&#x6CD5;&#xFF0C;&#x5B9E;&#x73B0;&#x7684;&#x4E5F;&#x662F;&#x4E00;&#x6837;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x8FD8;&#x5E26;&#x6709;pandas&#x7684;&#x6570;&#x636E;&#x5BF9;&#x9F50;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">114</span>]: b[:<span class="hljs-number">-2</span>].combine_first(a[<span class="hljs-number">2</span>:])
Out[<span class="hljs-number">114</span>]: 
a    NaN
b    <span class="hljs-number">4.5</span>
c    <span class="hljs-number">3.0</span>
d    <span class="hljs-number">2.0</span>
e    <span class="hljs-number">1.0</span>
f    <span class="hljs-number">0.0</span>
dtype: float64
</code></pre>
<p>&#x5BF9;&#x4E8E;DataFrame&#xFF0C;combine_first&#x81EA;&#x7136;&#x4E5F;&#x4F1A;&#x5728;&#x5217;&#x4E0A;&#x505A;&#x540C;&#x6837;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x56E0;&#x6B64;&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x770B;&#x505A;&#xFF1A;&#x7528;&#x4F20;&#x9012;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x4E3A;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x7684;&#x7F3A;&#x5931;&#x6570;&#x636E;&#x201C;&#x6253;&#x8865;&#x4E01;&#x201D;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">115</span>]: df1 = pd.DataFrame({<span class="hljs-string">&apos;a&apos;</span>: [<span class="hljs-number">1.</span>, np.nan, <span class="hljs-number">5.</span>, np.nan],
   .....:                     <span class="hljs-string">&apos;b&apos;</span>: [np.nan, <span class="hljs-number">2.</span>, np.nan, <span class="hljs-number">6.</span>],
   .....:                     <span class="hljs-string">&apos;c&apos;</span>: range(<span class="hljs-number">2</span>, <span class="hljs-number">18</span>, <span class="hljs-number">4</span>)})

In [<span class="hljs-number">116</span>]: df2 = pd.DataFrame({<span class="hljs-string">&apos;a&apos;</span>: [<span class="hljs-number">5.</span>, <span class="hljs-number">4.</span>, np.nan, <span class="hljs-number">3.</span>, <span class="hljs-number">7.</span>],
   .....:                     <span class="hljs-string">&apos;b&apos;</span>: [np.nan, <span class="hljs-number">3.</span>, <span class="hljs-number">4.</span>, <span class="hljs-number">6.</span>, <span class="hljs-number">8.</span>]})

In [<span class="hljs-number">117</span>]: df1
Out[<span class="hljs-number">117</span>]: 
     a    b   c
<span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  NaN   <span class="hljs-number">2</span>
<span class="hljs-number">1</span>  NaN  <span class="hljs-number">2.0</span>   <span class="hljs-number">6</span>
<span class="hljs-number">2</span>  <span class="hljs-number">5.0</span>  NaN  <span class="hljs-number">10</span>
<span class="hljs-number">3</span>  NaN  <span class="hljs-number">6.0</span>  <span class="hljs-number">14</span>

In [<span class="hljs-number">118</span>]: df2
Out[<span class="hljs-number">118</span>]: 
     a    b
<span class="hljs-number">0</span>  <span class="hljs-number">5.0</span>  NaN
<span class="hljs-number">1</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">3.0</span>
<span class="hljs-number">2</span>  NaN  <span class="hljs-number">4.0</span>
<span class="hljs-number">3</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">6.0</span>
<span class="hljs-number">4</span>  <span class="hljs-number">7.0</span>  <span class="hljs-number">8.0</span>

In [<span class="hljs-number">119</span>]: df1.combine_first(df2)
Out[<span class="hljs-number">119</span>]: 
     a    b     c
<span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  NaN   <span class="hljs-number">2.0</span>
<span class="hljs-number">1</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">2.0</span>   <span class="hljs-number">6.0</span>
<span class="hljs-number">2</span>  <span class="hljs-number">5.0</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">10.0</span>
<span class="hljs-number">3</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">6.0</span>  <span class="hljs-number">14.0</span>
<span class="hljs-number">4</span>  <span class="hljs-number">7.0</span>  <span class="hljs-number">8.0</span>   NaN
</code></pre>
<h1 id="83-&#x91CD;&#x5851;&#x548C;&#x8F74;&#x5411;&#x65CB;&#x8F6C;">8.3 &#x91CD;&#x5851;&#x548C;&#x8F74;&#x5411;&#x65CB;&#x8F6C;</h1>
<p>&#x6709;&#x8BB8;&#x591A;&#x7528;&#x4E8E;&#x91CD;&#x65B0;&#x6392;&#x5217;&#x8868;&#x683C;&#x578B;&#x6570;&#x636E;&#x7684;&#x57FA;&#x7840;&#x8FD0;&#x7B97;&#x3002;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x4E5F;&#x79F0;&#x4F5C;&#x91CD;&#x5851;&#xFF08;reshape&#xFF09;&#x6216;&#x8F74;&#x5411;&#x65CB;&#x8F6C;&#xFF08;pivot&#xFF09;&#x8FD0;&#x7B97;&#x3002;</p>
<h2 id="&#x91CD;&#x5851;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;">&#x91CD;&#x5851;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;</h2>
<p>&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#x4E3A;DataFrame&#x6570;&#x636E;&#x7684;&#x91CD;&#x6392;&#x4EFB;&#x52A1;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x5177;&#x6709;&#x826F;&#x597D;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x6709;&#x4E8C;&#xFF1A;</p>
<ul>
<li>stack&#xFF1A;&#x5C06;&#x6570;&#x636E;&#x7684;&#x5217;&#x201C;&#x65CB;&#x8F6C;&#x201D;&#x4E3A;&#x884C;&#x3002;</li>
<li>unstack&#xFF1A;&#x5C06;&#x6570;&#x636E;&#x7684;&#x884C;&#x201C;&#x65CB;&#x8F6C;&#x201D;&#x4E3A;&#x5217;&#x3002;</li>
</ul>
<p>&#x6211;&#x5C06;&#x901A;&#x8FC7;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x8303;&#x4F8B;&#x6765;&#x8BB2;&#x89E3;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;DataFrame&#xFF0C;&#x5176;&#x4E2D;&#x7684;&#x884C;&#x5217;&#x7D22;&#x5F15;&#x5747;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">120</span>]: data = pd.DataFrame(np.arange(<span class="hljs-number">6</span>).reshape((<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)),
   .....:                     index=pd.Index([<span class="hljs-string">&apos;Ohio&apos;</span>,<span class="hljs-string">&apos;Colorado&apos;</span>], name=<span class="hljs-string">&apos;state&apos;</span>),
   .....:                     columns=pd.Index([<span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;two&apos;</span>, <span class="hljs-string">&apos;three&apos;</span>],
   .....:                     name=<span class="hljs-string">&apos;number&apos;</span>))

In [<span class="hljs-number">121</span>]: data
Out[<span class="hljs-number">121</span>]: 
number    one  two  three
state                    
Ohio        <span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span>
Colorado    <span class="hljs-number">3</span>    <span class="hljs-number">4</span>      <span class="hljs-number">5</span>
</code></pre>
<p>&#x5BF9;&#x8BE5;&#x6570;&#x636E;&#x4F7F;&#x7528;stack&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x5C06;&#x5217;&#x8F6C;&#x6362;&#x4E3A;&#x884C;&#xFF0C;&#x5F97;&#x5230;&#x4E00;&#x4E2A;Series&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">122</span>]: result = data.stack()

In [<span class="hljs-number">123</span>]: result
Out[<span class="hljs-number">123</span>]: 
state     number
Ohio      one       <span class="hljs-number">0</span>
          two       <span class="hljs-number">1</span>
          three     <span class="hljs-number">2</span>
Colorado  one       <span class="hljs-number">3</span>
          two       <span class="hljs-number">4</span>
          three     <span class="hljs-number">5</span>
dtype: int64
</code></pre>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#x7684;Series&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7528;unstack&#x5C06;&#x5176;&#x91CD;&#x6392;&#x4E3A;&#x4E00;&#x4E2A;DataFrame&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">124</span>]: result.unstack()
Out[<span class="hljs-number">124</span>]: 
number    one  two  three
state                    
Ohio        <span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span>
Colorado    <span class="hljs-number">3</span>    <span class="hljs-number">4</span>      <span class="hljs-number">5</span>
</code></pre>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;unstack&#x64CD;&#x4F5C;&#x7684;&#x662F;&#x6700;&#x5185;&#x5C42;&#xFF08;stack&#x4E5F;&#x662F;&#x5982;&#x6B64;&#xFF09;&#x3002;&#x4F20;&#x5165;&#x5206;&#x5C42;&#x7EA7;&#x522B;&#x7684;&#x7F16;&#x53F7;&#x6216;&#x540D;&#x79F0;&#x5373;&#x53EF;&#x5BF9;&#x5176;&#x5B83;&#x7EA7;&#x522B;&#x8FDB;&#x884C;unstack&#x64CD;&#x4F5C;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">125</span>]: result.unstack(<span class="hljs-number">0</span>)
Out[<span class="hljs-number">125</span>]: 
state   Ohio  Colorado
number                
one        <span class="hljs-number">0</span>         <span class="hljs-number">3</span>
two        <span class="hljs-number">1</span>         <span class="hljs-number">4</span>
three      <span class="hljs-number">2</span>         <span class="hljs-number">5</span>

In [<span class="hljs-number">126</span>]: result.unstack(<span class="hljs-string">&apos;state&apos;</span>)
Out[<span class="hljs-number">126</span>]: 
state   Ohio  Colorado
number                
one        <span class="hljs-number">0</span>         <span class="hljs-number">3</span>
two        <span class="hljs-number">1</span>         <span class="hljs-number">4</span>
three      <span class="hljs-number">2</span>         <span class="hljs-number">5</span>
</code></pre>
<p>&#x5982;&#x679C;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#x7EA7;&#x522B;&#x503C;&#x90FD;&#x80FD;&#x5728;&#x5404;&#x5206;&#x7EC4;&#x4E2D;&#x627E;&#x5230;&#x7684;&#x8BDD;&#xFF0C;&#x5219;unstack&#x64CD;&#x4F5C;&#x53EF;&#x80FD;&#x4F1A;&#x5F15;&#x5165;&#x7F3A;&#x5931;&#x6570;&#x636E;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">127</span>]: s1 = pd.Series([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], index=[<span class="hljs-string">&apos;a&apos;</span>, <span class="hljs-string">&apos;b&apos;</span>, <span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>])

In [<span class="hljs-number">128</span>]: s2 = pd.Series([<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>], index=[<span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>, <span class="hljs-string">&apos;e&apos;</span>])

In [<span class="hljs-number">129</span>]: data2 = pd.concat([s1, s2], keys=[<span class="hljs-string">&apos;one&apos;</span>, <span class="hljs-string">&apos;two&apos;</span>])

In [<span class="hljs-number">130</span>]: data2
Out[<span class="hljs-number">130</span>]: 
one  a    <span class="hljs-number">0</span>
     b    <span class="hljs-number">1</span>
     c    <span class="hljs-number">2</span>
     d    <span class="hljs-number">3</span>
two  c    <span class="hljs-number">4</span>
     d    <span class="hljs-number">5</span>
     e    <span class="hljs-number">6</span>
dtype: int64

In [<span class="hljs-number">131</span>]: data2.unstack()
Out[<span class="hljs-number">131</span>]: 
       a    b    c    d    e
one  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span>  NaN
two  NaN  NaN  <span class="hljs-number">4.0</span>  <span class="hljs-number">5.0</span>  <span class="hljs-number">6.0</span>
</code></pre>
<p>stack&#x9ED8;&#x8BA4;&#x4F1A;&#x6EE4;&#x9664;&#x7F3A;&#x5931;&#x6570;&#x636E;&#xFF0C;&#x56E0;&#x6B64;&#x8BE5;&#x8FD0;&#x7B97;&#x662F;&#x53EF;&#x9006;&#x7684;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">132</span>]: data2.unstack()
Out[<span class="hljs-number">132</span>]: 
       a    b    c    d    e
one  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span>  NaN
two  NaN  NaN  <span class="hljs-number">4.0</span>  <span class="hljs-number">5.0</span>  <span class="hljs-number">6.0</span>

In [<span class="hljs-number">133</span>]: data2.unstack().stack()
Out[<span class="hljs-number">133</span>]: 
one  a    <span class="hljs-number">0.0</span>
     b    <span class="hljs-number">1.0</span>
     c    <span class="hljs-number">2.0</span>
     d    <span class="hljs-number">3.0</span>
two  c    <span class="hljs-number">4.0</span>
     d    <span class="hljs-number">5.0</span>
     e    <span class="hljs-number">6.0</span>
dtype: float64

In [<span class="hljs-number">134</span>]: data2.unstack().stack(dropna=<span class="hljs-keyword">False</span>)
Out[<span class="hljs-number">134</span>]: 
one  a    <span class="hljs-number">0.0</span>
     b    <span class="hljs-number">1.0</span>
     c    <span class="hljs-number">2.0</span>
     d    <span class="hljs-number">3.0</span>
     e    NaN
two  a    NaN
     b    NaN
     c    <span class="hljs-number">4.0</span>
     d    <span class="hljs-number">5.0</span>
     e    <span class="hljs-number">6.0</span>
dtype: float64
</code></pre>
<p>&#x5728;&#x5BF9;DataFrame&#x8FDB;&#x884C;unstack&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x4F5C;&#x4E3A;&#x65CB;&#x8F6C;&#x8F74;&#x7684;&#x7EA7;&#x522B;&#x5C06;&#x4F1A;&#x6210;&#x4E3A;&#x7ED3;&#x679C;&#x4E2D;&#x7684;&#x6700;&#x4F4E;&#x7EA7;&#x522B;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">135</span>]: df = pd.DataFrame({<span class="hljs-string">&apos;left&apos;</span>: result, <span class="hljs-string">&apos;right&apos;</span>: result + <span class="hljs-number">5</span>},
   .....:                   columns=pd.Index([<span class="hljs-string">&apos;left&apos;</span>, <span class="hljs-string">&apos;right&apos;</span>], name=<span class="hljs-string">&apos;side&apos;</span>))

In [<span class="hljs-number">136</span>]: df
Out[<span class="hljs-number">136</span>]: 
side             left  right
state    number             
Ohio     one        <span class="hljs-number">0</span>      <span class="hljs-number">5</span>
         two        <span class="hljs-number">1</span>      <span class="hljs-number">6</span>
         three      <span class="hljs-number">2</span>      <span class="hljs-number">7</span>
Colorado one        <span class="hljs-number">3</span>      <span class="hljs-number">8</span>
         two        <span class="hljs-number">4</span>      <span class="hljs-number">9</span>
         three      <span class="hljs-number">5</span>     <span class="hljs-number">10</span>

In [<span class="hljs-number">137</span>]: df.unstack(<span class="hljs-string">&apos;state&apos;</span>)
Out[<span class="hljs-number">137</span>]: 
side   left          right
state  Ohio Colorado  Ohio Colorado
number                             
one       <span class="hljs-number">0</span>        <span class="hljs-number">3</span>     <span class="hljs-number">5</span>        <span class="hljs-number">8</span>
two       <span class="hljs-number">1</span>        <span class="hljs-number">4</span>     <span class="hljs-number">6</span>        <span class="hljs-number">9</span>
three     <span class="hljs-number">2</span>        <span class="hljs-number">5</span>     <span class="hljs-number">7</span>       <span class="hljs-number">10</span>
</code></pre>
<p>&#x5F53;&#x8C03;&#x7528;stack&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6307;&#x660E;&#x8F74;&#x7684;&#x540D;&#x5B57;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">138</span>]: df.unstack(<span class="hljs-string">&apos;state&apos;</span>).stack(<span class="hljs-string">&apos;side&apos;</span>)
Out[<span class="hljs-number">138</span>]: 
state         Colorado  Ohio
number side                 
one    left          <span class="hljs-number">3</span>     <span class="hljs-number">0</span>
       right         <span class="hljs-number">8</span>     <span class="hljs-number">5</span>
two    left          <span class="hljs-number">4</span>     <span class="hljs-number">1</span>
       right         <span class="hljs-number">9</span>     <span class="hljs-number">6</span>
three  left          <span class="hljs-number">5</span>     <span class="hljs-number">2</span>
       right        <span class="hljs-number">10</span>     <span class="hljs-number">7</span>
</code></pre>
<h2 id="&#x5C06;&#x957F;&#x683C;&#x5F0F;&#x65CB;&#x8F6C;&#x4E3A;&#x5BBD;&#x683C;&#x5F0F;">&#x5C06;&#x201C;&#x957F;&#x683C;&#x5F0F;&#x201D;&#x65CB;&#x8F6C;&#x4E3A;&#x201C;&#x5BBD;&#x683C;&#x5F0F;&#x201D;</h2>
<p>&#x591A;&#x4E2A;&#x65F6;&#x95F4;&#x5E8F;&#x5217;&#x6570;&#x636E;&#x901A;&#x5E38;&#x662F;&#x4EE5;&#x6240;&#x8C13;&#x7684;&#x201C;&#x957F;&#x683C;&#x5F0F;&#x201D;&#xFF08;long&#xFF09;&#x6216;&#x201C;&#x5806;&#x53E0;&#x683C;&#x5F0F;&#x201D;&#xFF08;stacked&#xFF09;&#x5B58;&#x50A8;&#x5728;&#x6570;&#x636E;&#x5E93;&#x548C;CSV&#x4E2D;&#x7684;&#x3002;&#x6211;&#x4EEC;&#x5148;&#x52A0;&#x8F7D;&#x4E00;&#x4E9B;&#x793A;&#x4F8B;&#x6570;&#x636E;&#xFF0C;&#x505A;&#x4E00;&#x4E9B;&#x65F6;&#x95F4;&#x5E8F;&#x5217;&#x89C4;&#x6574;&#x548C;&#x6570;&#x636E;&#x6E05;&#x6D17;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">139</span>]: data = pd.read_csv(<span class="hljs-string">&apos;examples/macrodata.csv&apos;</span>)

In [<span class="hljs-number">140</span>]: data.head()
Out[<span class="hljs-number">140</span>]: 
     year  quarter   realgdp  realcons  realinv  realgovt  realdpi    cpi  \
<span class="hljs-number">0</span>  <span class="hljs-number">1959.0</span>      <span class="hljs-number">1.0</span>  <span class="hljs-number">2710.349</span>    <span class="hljs-number">1707.4</span>  <span class="hljs-number">286.898</span>   <span class="hljs-number">470.045</span>   <span class="hljs-number">1886.9</span>  <span class="hljs-number">28.98</span>   
<span class="hljs-number">1</span>  <span class="hljs-number">1959.0</span>      <span class="hljs-number">2.0</span>  <span class="hljs-number">2778.801</span>    <span class="hljs-number">1733.7</span>  <span class="hljs-number">310.859</span>   <span class="hljs-number">481.301</span>   <span class="hljs-number">1919.7</span>  <span class="hljs-number">29.15</span>   
<span class="hljs-number">2</span>  <span class="hljs-number">1959.0</span>      <span class="hljs-number">3.0</span>  <span class="hljs-number">2775.488</span>    <span class="hljs-number">1751.8</span>  <span class="hljs-number">289.226</span>   <span class="hljs-number">491.260</span>   <span class="hljs-number">1916.4</span>  <span class="hljs-number">29.35</span>   
<span class="hljs-number">3</span>  <span class="hljs-number">1959.0</span>      <span class="hljs-number">4.0</span>  <span class="hljs-number">2785.204</span>    <span class="hljs-number">1753.7</span>  <span class="hljs-number">299.356</span>   <span class="hljs-number">484.052</span>   <span class="hljs-number">1931.3</span>  <span class="hljs-number">29.37</span>   
<span class="hljs-number">4</span>  <span class="hljs-number">1960.0</span>      <span class="hljs-number">1.0</span>  <span class="hljs-number">2847.699</span>    <span class="hljs-number">1770.5</span>  <span class="hljs-number">331.722</span>   <span class="hljs-number">462.199</span>   <span class="hljs-number">1955.5</span>  <span class="hljs-number">29.54</span>   
      m1  tbilrate  unemp      pop  infl  realint  
<span class="hljs-number">0</span>  <span class="hljs-number">139.7</span>      <span class="hljs-number">2.82</span>    <span class="hljs-number">5.8</span>  <span class="hljs-number">177.146</span>  <span class="hljs-number">0.00</span>     <span class="hljs-number">0.00</span>
<span class="hljs-number">1</span>  <span class="hljs-number">141.7</span>      <span class="hljs-number">3.08</span>    <span class="hljs-number">5.1</span>  <span class="hljs-number">177.830</span>  <span class="hljs-number">2.34</span>     <span class="hljs-number">0.74</span>  
<span class="hljs-number">2</span>  <span class="hljs-number">140.5</span>      <span class="hljs-number">3.82</span>    <span class="hljs-number">5.3</span>  <span class="hljs-number">178.657</span>  <span class="hljs-number">2.74</span>     <span class="hljs-number">1.09</span>  
<span class="hljs-number">3</span>  <span class="hljs-number">140.0</span>      <span class="hljs-number">4.33</span>    <span class="hljs-number">5.6</span>  <span class="hljs-number">179.386</span>  <span class="hljs-number">0.27</span>     <span class="hljs-number">4.06</span>  
<span class="hljs-number">4</span>  <span class="hljs-number">139.6</span>      <span class="hljs-number">3.50</span>    <span class="hljs-number">5.2</span>  <span class="hljs-number">180.007</span>  <span class="hljs-number">2.31</span>     <span class="hljs-number">1.19</span>  

In [<span class="hljs-number">141</span>]: periods = pd.PeriodIndex(year=data.year, quarter=data.quarter,
   .....:                          name=<span class="hljs-string">&apos;date&apos;</span>)

In [<span class="hljs-number">142</span>]: columns = pd.Index([<span class="hljs-string">&apos;realgdp&apos;</span>, <span class="hljs-string">&apos;infl&apos;</span>, <span class="hljs-string">&apos;unemp&apos;</span>], name=<span class="hljs-string">&apos;item&apos;</span>)

In [<span class="hljs-number">143</span>]: data = data.reindex(columns=columns)

In [<span class="hljs-number">144</span>]: data.index = periods.to_timestamp(<span class="hljs-string">&apos;D&apos;</span>, <span class="hljs-string">&apos;end&apos;</span>)

In [<span class="hljs-number">145</span>]: ldata = data.stack().reset_index().rename(columns={<span class="hljs-number">0</span>: <span class="hljs-string">&apos;value&apos;</span>})
</code></pre>
<p>&#x8FD9;&#x5C31;&#x662F;&#x591A;&#x4E2A;&#x65F6;&#x95F4;&#x5E8F;&#x5217;&#xFF08;&#x6216;&#x8005;&#x5176;&#x5B83;&#x5E26;&#x6709;&#x4E24;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x952E;&#x7684;&#x53EF;&#x89C2;&#x5BDF;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x952E;&#x662F;date&#x548C;item&#xFF09;&#x7684;&#x957F;&#x683C;&#x5F0F;&#x3002;&#x8868;&#x4E2D;&#x7684;&#x6BCF;&#x884C;&#x4EE3;&#x8868;&#x4E00;&#x6B21;&#x89C2;&#x5BDF;&#x3002;</p>
<p>&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#xFF08;&#x5982;MySQL&#xFF09;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x7ECF;&#x5E38;&#x90FD;&#x662F;&#x8FD9;&#x6837;&#x5B58;&#x50A8;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x56FA;&#x5B9A;&#x67B6;&#x6784;&#xFF08;&#x5373;&#x5217;&#x540D;&#x548C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF09;&#x6709;&#x4E00;&#x4E2A;&#x597D;&#x5904;&#xFF1A;&#x968F;&#x7740;&#x8868;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x6DFB;&#x52A0;&#xFF0C;item&#x5217;&#x4E2D;&#x7684;&#x503C;&#x7684;&#x79CD;&#x7C7B;&#x80FD;&#x591F;&#x589E;&#x52A0;&#x3002;&#x5728;&#x524D;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;date&#x548C;item&#x901A;&#x5E38;&#x5C31;&#x662F;&#x4E3B;&#x952E;&#xFF08;&#x7528;&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8BF4;&#x6CD5;&#xFF09;&#xFF0C;&#x4E0D;&#x4EC5;&#x63D0;&#x4F9B;&#x4E86;&#x5173;&#x7CFB;&#x5B8C;&#x6574;&#x6027;&#xFF0C;&#x800C;&#x4E14;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x4E3A;&#x7B80;&#x5355;&#x7684;&#x67E5;&#x8BE2;&#x652F;&#x6301;&#x3002;&#x6709;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;&#x8FD9;&#x6837;&#x7684;&#x6570;&#x636E;&#x4F1A;&#x5F88;&#x9EBB;&#x70E6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x66F4;&#x559C;&#x6B22;DataFrame&#xFF0C;&#x4E0D;&#x540C;&#x7684;item&#x503C;&#x5206;&#x522B;&#x5F62;&#x6210;&#x4E00;&#x5217;&#xFF0C;date&#x5217;&#x4E2D;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x5219;&#x7528;&#x4F5C;&#x7D22;&#x5F15;&#x3002;DataFrame&#x7684;pivot&#x65B9;&#x6CD5;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x8F6C;&#x6362;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">147</span>]: pivoted = ldata.pivot(<span class="hljs-string">&apos;date&apos;</span>, <span class="hljs-string">&apos;item&apos;</span>, <span class="hljs-string">&apos;value&apos;</span>)

In [<span class="hljs-number">148</span>]: pivoted
Out[<span class="hljs-number">148</span>]: 
item        infl    realgdp  unemp
date                              
<span class="hljs-number">1959</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.00</span>   <span class="hljs-number">2710.349</span>    <span class="hljs-number">5.8</span>
<span class="hljs-number">1959</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.34</span>   <span class="hljs-number">2778.801</span>    <span class="hljs-number">5.1</span>
<span class="hljs-number">1959</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.74</span>   <span class="hljs-number">2775.488</span>    <span class="hljs-number">5.3</span>
<span class="hljs-number">1959</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.27</span>   <span class="hljs-number">2785.204</span>    <span class="hljs-number">5.6</span>
<span class="hljs-number">1960</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">2.31</span>   <span class="hljs-number">2847.699</span>    <span class="hljs-number">5.2</span>
<span class="hljs-number">1960</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">0.14</span>   <span class="hljs-number">2834.390</span>    <span class="hljs-number">5.2</span>
<span class="hljs-number">1960</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.70</span>   <span class="hljs-number">2839.022</span>    <span class="hljs-number">5.6</span>
<span class="hljs-number">1960</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>  <span class="hljs-number">1.21</span>   <span class="hljs-number">2802.616</span>    <span class="hljs-number">6.3</span>
<span class="hljs-number">1961</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span> <span class="hljs-number">-0.40</span>   <span class="hljs-number">2819.264</span>    <span class="hljs-number">6.8</span>
<span class="hljs-number">1961</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">1.47</span>   <span class="hljs-number">2872.005</span>    <span class="hljs-number">7.0</span>
<span class="hljs-meta">... </span>         ...        ...    ...
<span class="hljs-number">2007</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.75</span>  <span class="hljs-number">13203.977</span>    <span class="hljs-number">4.5</span>
<span class="hljs-number">2007</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  <span class="hljs-number">3.45</span>  <span class="hljs-number">13321.109</span>    <span class="hljs-number">4.7</span>
<span class="hljs-number">2007</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>  <span class="hljs-number">6.38</span>  <span class="hljs-number">13391.249</span>    <span class="hljs-number">4.8</span>
<span class="hljs-number">2008</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">2.82</span>  <span class="hljs-number">13366.865</span>    <span class="hljs-number">4.9</span>
<span class="hljs-number">2008</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">8.53</span>  <span class="hljs-number">13415.266</span>    <span class="hljs-number">5.4</span>
<span class="hljs-number">2008</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span> <span class="hljs-number">-3.16</span>  <span class="hljs-number">13324.600</span>    <span class="hljs-number">6.0</span>
<span class="hljs-number">2008</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span> <span class="hljs-number">-8.79</span>  <span class="hljs-number">13141.920</span>    <span class="hljs-number">6.9</span>
<span class="hljs-number">2009</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.94</span>  <span class="hljs-number">12925.410</span>    <span class="hljs-number">8.1</span>
<span class="hljs-number">2009</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">3.37</span>  <span class="hljs-number">12901.504</span>    <span class="hljs-number">9.2</span>
<span class="hljs-number">2009</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  <span class="hljs-number">3.56</span>  <span class="hljs-number">12990.341</span>    <span class="hljs-number">9.6</span>
[<span class="hljs-number">203</span> rows x <span class="hljs-number">3</span> columns]
</code></pre>
<p>&#x524D;&#x4E24;&#x4E2A;&#x4F20;&#x9012;&#x7684;&#x503C;&#x5206;&#x522B;&#x7528;&#x4F5C;&#x884C;&#x548C;&#x5217;&#x7D22;&#x5F15;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x503C;&#x5219;&#x662F;&#x7528;&#x4E8E;&#x586B;&#x5145;DataFrame&#x7684;&#x6570;&#x636E;&#x5217;&#x3002;&#x5047;&#x8BBE;&#x6709;&#x4E24;&#x4E2A;&#x9700;&#x8981;&#x540C;&#x65F6;&#x91CD;&#x5851;&#x7684;&#x6570;&#x636E;&#x5217;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">149</span>]: ldata[<span class="hljs-string">&apos;value2&apos;</span>] = np.random.randn(len(ldata))

In [<span class="hljs-number">150</span>]: ldata[:<span class="hljs-number">10</span>]
Out[<span class="hljs-number">150</span>]: 
        date     item     value    value2
<span class="hljs-number">0</span> <span class="hljs-number">1959</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  realgdp  <span class="hljs-number">2710.349</span>  <span class="hljs-number">0.523772</span>
<span class="hljs-number">1</span> <span class="hljs-number">1959</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>     infl     <span class="hljs-number">0.000</span>  <span class="hljs-number">0.000940</span>
<span class="hljs-number">2</span> <span class="hljs-number">1959</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>    unemp     <span class="hljs-number">5.800</span>  <span class="hljs-number">1.343810</span>
<span class="hljs-number">3</span> <span class="hljs-number">1959</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  realgdp  <span class="hljs-number">2778.801</span> <span class="hljs-number">-0.713544</span>
<span class="hljs-number">4</span> <span class="hljs-number">1959</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>     infl     <span class="hljs-number">2.340</span> <span class="hljs-number">-0.831154</span>
<span class="hljs-number">5</span> <span class="hljs-number">1959</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>    unemp     <span class="hljs-number">5.100</span> <span class="hljs-number">-2.370232</span>
<span class="hljs-number">6</span> <span class="hljs-number">1959</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  realgdp  <span class="hljs-number">2775.488</span> <span class="hljs-number">-1.860761</span>
<span class="hljs-number">7</span> <span class="hljs-number">1959</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>     infl     <span class="hljs-number">2.740</span> <span class="hljs-number">-0.860757</span>
<span class="hljs-number">8</span> <span class="hljs-number">1959</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>    unemp     <span class="hljs-number">5.300</span>  <span class="hljs-number">0.560145</span>
<span class="hljs-number">9</span> <span class="hljs-number">1959</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>  realgdp  <span class="hljs-number">2785.204</span> <span class="hljs-number">-1.265934</span>
</code></pre>
<p>&#x5982;&#x679C;&#x5FFD;&#x7565;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5F97;&#x5230;&#x7684;DataFrame&#x5C31;&#x4F1A;&#x5E26;&#x6709;&#x5C42;&#x6B21;&#x5316;&#x7684;&#x5217;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">151</span>]: pivoted = ldata.pivot(<span class="hljs-string">&apos;date&apos;</span>, <span class="hljs-string">&apos;item&apos;</span>)

In [<span class="hljs-number">152</span>]: pivoted[:<span class="hljs-number">5</span>]
Out[<span class="hljs-number">152</span>]: 
           value                    value2                    
item        infl   realgdp unemp      infl   realgdp     unemp
date                                                          
<span class="hljs-number">1959</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">2710.349</span>   <span class="hljs-number">5.8</span>  <span class="hljs-number">0.000940</span>  <span class="hljs-number">0.523772</span>  <span class="hljs-number">1.343810</span>
<span class="hljs-number">1959</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.34</span>  <span class="hljs-number">2778.801</span>   <span class="hljs-number">5.1</span> <span class="hljs-number">-0.831154</span> <span class="hljs-number">-0.713544</span> <span class="hljs-number">-2.370232</span>
<span class="hljs-number">1959</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.74</span>  <span class="hljs-number">2775.488</span>   <span class="hljs-number">5.3</span> <span class="hljs-number">-0.860757</span> <span class="hljs-number">-1.860761</span>  <span class="hljs-number">0.560145</span>
<span class="hljs-number">1959</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.27</span>  <span class="hljs-number">2785.204</span>   <span class="hljs-number">5.6</span>  <span class="hljs-number">0.119827</span> <span class="hljs-number">-1.265934</span> <span class="hljs-number">-1.063512</span>
<span class="hljs-number">1960</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">2.31</span>  <span class="hljs-number">2847.699</span>   <span class="hljs-number">5.2</span> <span class="hljs-number">-2.359419</span>  <span class="hljs-number">0.332883</span> <span class="hljs-number">-0.199543</span>

In [<span class="hljs-number">153</span>]: pivoted[<span class="hljs-string">&apos;value&apos;</span>][:<span class="hljs-number">5</span>]
Out[<span class="hljs-number">153</span>]: 
item        infl   realgdp  unemp
date                             
<span class="hljs-number">1959</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">2710.349</span>    <span class="hljs-number">5.8</span>
<span class="hljs-number">1959</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.34</span>  <span class="hljs-number">2778.801</span>    <span class="hljs-number">5.1</span>
<span class="hljs-number">1959</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.74</span>  <span class="hljs-number">2775.488</span>    <span class="hljs-number">5.3</span>
<span class="hljs-number">1959</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.27</span>  <span class="hljs-number">2785.204</span>    <span class="hljs-number">5.6</span>
<span class="hljs-number">1960</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">2.31</span>  <span class="hljs-number">2847.699</span>    <span class="hljs-number">5.2</span>
</code></pre>
<p>&#x6CE8;&#x610F;&#xFF0C;pivot&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x7528;set_index&#x521B;&#x5EFA;&#x5C42;&#x6B21;&#x5316;&#x7D22;&#x5F15;&#xFF0C;&#x518D;&#x7528;unstack&#x91CD;&#x5851;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">154</span>]: unstacked = ldata.set_index([<span class="hljs-string">&apos;date&apos;</span>, <span class="hljs-string">&apos;item&apos;</span>]).unstack(<span class="hljs-string">&apos;item&apos;</span>)

In [<span class="hljs-number">155</span>]: unstacked[:<span class="hljs-number">7</span>]
Out[<span class="hljs-number">155</span>]: 
           value                    value2                    
item        infl   realgdp unemp      infl   realgdp     unemp
date                                                          
<span class="hljs-number">1959</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">2710.349</span>   <span class="hljs-number">5.8</span>  <span class="hljs-number">0.000940</span>  <span class="hljs-number">0.523772</span>  <span class="hljs-number">1.343810</span>
<span class="hljs-number">1959</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.34</span>  <span class="hljs-number">2778.801</span>   <span class="hljs-number">5.1</span> <span class="hljs-number">-0.831154</span> <span class="hljs-number">-0.713544</span> <span class="hljs-number">-2.370232</span>
<span class="hljs-number">1959</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.74</span>  <span class="hljs-number">2775.488</span>   <span class="hljs-number">5.3</span> <span class="hljs-number">-0.860757</span> <span class="hljs-number">-1.860761</span>  <span class="hljs-number">0.560145</span>
<span class="hljs-number">1959</span><span class="hljs-number">-12</span><span class="hljs-number">-31</span>  <span class="hljs-number">0.27</span>  <span class="hljs-number">2785.204</span>   <span class="hljs-number">5.6</span>  <span class="hljs-number">0.119827</span> <span class="hljs-number">-1.265934</span> <span class="hljs-number">-1.063512</span>
<span class="hljs-number">1960</span><span class="hljs-number">-03</span><span class="hljs-number">-31</span>  <span class="hljs-number">2.31</span>  <span class="hljs-number">2847.699</span>   <span class="hljs-number">5.2</span> <span class="hljs-number">-2.359419</span>  <span class="hljs-number">0.332883</span> <span class="hljs-number">-0.199543</span>
<span class="hljs-number">1960</span><span class="hljs-number">-06</span><span class="hljs-number">-30</span>  <span class="hljs-number">0.14</span>  <span class="hljs-number">2834.390</span>   <span class="hljs-number">5.2</span> <span class="hljs-number">-0.970736</span> <span class="hljs-number">-1.541996</span> <span class="hljs-number">-1.307030</span>
<span class="hljs-number">1960</span><span class="hljs-number">-09</span><span class="hljs-number">-30</span>  <span class="hljs-number">2.70</span>  <span class="hljs-number">2839.022</span>   <span class="hljs-number">5.6</span>  <span class="hljs-number">0.377984</span>  <span class="hljs-number">0.286350</span> <span class="hljs-number">-0.753887</span>
</code></pre>
<h2 id="&#x5C06;&#x5BBD;&#x683C;&#x5F0F;&#x65CB;&#x8F6C;&#x4E3A;&#x957F;&#x683C;&#x5F0F;">&#x5C06;&#x201C;&#x5BBD;&#x683C;&#x5F0F;&#x201D;&#x65CB;&#x8F6C;&#x4E3A;&#x201C;&#x957F;&#x683C;&#x5F0F;&#x201D;</h2>
<p>&#x65CB;&#x8F6C;DataFrame&#x7684;&#x9006;&#x8FD0;&#x7B97;&#x662F;pandas.melt&#x3002;&#x5B83;&#x4E0D;&#x662F;&#x5C06;&#x4E00;&#x5217;&#x8F6C;&#x6362;&#x5230;&#x591A;&#x4E2A;&#x65B0;&#x7684;DataFrame&#xFF0C;&#x800C;&#x662F;&#x5408;&#x5E76;&#x591A;&#x4E2A;&#x5217;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#xFF0C;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F93;&#x5165;&#x957F;&#x7684;DataFrame&#x3002;&#x770B;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">157</span>]: df = pd.DataFrame({<span class="hljs-string">&apos;key&apos;</span>: [<span class="hljs-string">&apos;foo&apos;</span>, <span class="hljs-string">&apos;bar&apos;</span>, <span class="hljs-string">&apos;baz&apos;</span>],
   .....:                    <span class="hljs-string">&apos;A&apos;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
   .....:                    <span class="hljs-string">&apos;B&apos;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],
   .....:                    <span class="hljs-string">&apos;C&apos;</span>: [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]})

In [<span class="hljs-number">158</span>]: df
Out[<span class="hljs-number">158</span>]: 
   A  B  C  key
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">4</span>  <span class="hljs-number">7</span>  foo
<span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  <span class="hljs-number">8</span>  bar
<span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">6</span>  <span class="hljs-number">9</span>  baz
</code></pre>
<p>key&#x5217;&#x53EF;&#x80FD;&#x662F;&#x5206;&#x7EC4;&#x6307;&#x6807;&#xFF0C;&#x5176;&#x5B83;&#x7684;&#x5217;&#x662F;&#x6570;&#x636E;&#x503C;&#x3002;&#x5F53;&#x4F7F;&#x7528;pandas.melt&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x6307;&#x660E;&#x54EA;&#x4E9B;&#x5217;&#x662F;&#x5206;&#x7EC4;&#x6307;&#x6807;&#x3002;&#x4E0B;&#x9762;&#x4F7F;&#x7528;key&#x4F5C;&#x4E3A;&#x552F;&#x4E00;&#x7684;&#x5206;&#x7EC4;&#x6307;&#x6807;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">159</span>]: melted = pd.melt(df, [<span class="hljs-string">&apos;key&apos;</span>])

In [<span class="hljs-number">160</span>]: melted
Out[<span class="hljs-number">160</span>]: 
   key variable  value
<span class="hljs-number">0</span>  foo        A      <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  bar        A      <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  baz        A      <span class="hljs-number">3</span>
<span class="hljs-number">3</span>  foo        B      <span class="hljs-number">4</span>
<span class="hljs-number">4</span>  bar        B      <span class="hljs-number">5</span>
<span class="hljs-number">5</span>  baz        B      <span class="hljs-number">6</span>
<span class="hljs-number">6</span>  foo        C      <span class="hljs-number">7</span>
<span class="hljs-number">7</span>  bar        C      <span class="hljs-number">8</span>
<span class="hljs-number">8</span>  baz        C      <span class="hljs-number">9</span>
</code></pre>
<p>&#x4F7F;&#x7528;pivot&#xFF0C;&#x53EF;&#x4EE5;&#x91CD;&#x5851;&#x56DE;&#x539F;&#x6765;&#x7684;&#x6837;&#x5B50;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">161</span>]: reshaped = melted.pivot(<span class="hljs-string">&apos;key&apos;</span>, <span class="hljs-string">&apos;variable&apos;</span>, <span class="hljs-string">&apos;value&apos;</span>)

In [<span class="hljs-number">162</span>]: reshaped
Out[<span class="hljs-number">162</span>]: 
variable  A  B  C
key              
bar       <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  <span class="hljs-number">8</span>
baz       <span class="hljs-number">3</span>  <span class="hljs-number">6</span>  <span class="hljs-number">9</span>
foo       <span class="hljs-number">1</span>  <span class="hljs-number">4</span>  <span class="hljs-number">7</span>
</code></pre>
<p>&#x56E0;&#x4E3A;pivot&#x7684;&#x7ED3;&#x679C;&#x4ECE;&#x5217;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x7D22;&#x5F15;&#xFF0C;&#x7528;&#x4F5C;&#x884C;&#x6807;&#x7B7E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;reset_index&#x5C06;&#x6570;&#x636E;&#x79FB;&#x56DE;&#x5217;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">163</span>]: reshaped.reset_index()
Out[<span class="hljs-number">163</span>]: 
variable  key  A  B  C
<span class="hljs-number">0</span>         bar  <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  <span class="hljs-number">8</span>
<span class="hljs-number">1</span>         baz  <span class="hljs-number">3</span>  <span class="hljs-number">6</span>  <span class="hljs-number">9</span>
<span class="hljs-number">2</span>         foo  <span class="hljs-number">1</span>  <span class="hljs-number">4</span>  <span class="hljs-number">7</span>
</code></pre>
<p>&#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x5217;&#x7684;&#x5B50;&#x96C6;&#xFF0C;&#x4F5C;&#x4E3A;&#x503C;&#x7684;&#x5217;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">164</span>]: pd.melt(df, id_vars=[<span class="hljs-string">&apos;key&apos;</span>], value_vars=[<span class="hljs-string">&apos;A&apos;</span>, <span class="hljs-string">&apos;B&apos;</span>])
Out[<span class="hljs-number">164</span>]: 
   key variable  value
<span class="hljs-number">0</span>  foo        A      <span class="hljs-number">1</span>
<span class="hljs-number">1</span>  bar        A      <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  baz        A      <span class="hljs-number">3</span>
<span class="hljs-number">3</span>  foo        B      <span class="hljs-number">4</span>
<span class="hljs-number">4</span>  bar        B      <span class="hljs-number">5</span>
<span class="hljs-number">5</span>  baz        B      <span class="hljs-number">6</span>
</code></pre>
<p>pandas.melt&#x4E5F;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x5206;&#x7EC4;&#x6307;&#x6807;&#xFF1A;</p>
<pre><code class="lang-python">In [<span class="hljs-number">165</span>]: pd.melt(df, value_vars=[<span class="hljs-string">&apos;A&apos;</span>, <span class="hljs-string">&apos;B&apos;</span>, <span class="hljs-string">&apos;C&apos;</span>])
Out[<span class="hljs-number">165</span>]: 
  variable  value
<span class="hljs-number">0</span>        A      <span class="hljs-number">1</span>
<span class="hljs-number">1</span>        A      <span class="hljs-number">2</span>
<span class="hljs-number">2</span>        A      <span class="hljs-number">3</span>
<span class="hljs-number">3</span>        B      <span class="hljs-number">4</span>
<span class="hljs-number">4</span>        B      <span class="hljs-number">5</span>
<span class="hljs-number">5</span>        B      <span class="hljs-number">6</span>
<span class="hljs-number">6</span>        C      <span class="hljs-number">7</span>
<span class="hljs-number">7</span>        C      <span class="hljs-number">8</span>
<span class="hljs-number">8</span>        C      <span class="hljs-number">9</span>

In [<span class="hljs-number">166</span>]: pd.melt(df, value_vars=[<span class="hljs-string">&apos;key&apos;</span>, <span class="hljs-string">&apos;A&apos;</span>, <span class="hljs-string">&apos;B&apos;</span>])
Out[<span class="hljs-number">166</span>]: 
  variable value
<span class="hljs-number">0</span>      key   foo
<span class="hljs-number">1</span>      key   bar
<span class="hljs-number">2</span>      key   baz
<span class="hljs-number">3</span>        A     <span class="hljs-number">1</span>
<span class="hljs-number">4</span>        A     <span class="hljs-number">2</span>
<span class="hljs-number">5</span>        A     <span class="hljs-number">3</span>
<span class="hljs-number">6</span>        B     <span class="hljs-number">4</span>
<span class="hljs-number">7</span>        B     <span class="hljs-number">5</span>
<span class="hljs-number">8</span>        B     <span class="hljs-number">6</span>
</code></pre>
<h1 id="84-&#x603B;&#x7ED3;">8.4 &#x603B;&#x7ED3;</h1>
<p>&#x73B0;&#x5728;&#x4F60;&#x5DF2;&#x7ECF;&#x638C;&#x63E1;&#x4E86;pandas&#x6570;&#x636E;&#x5BFC;&#x5165;&#x3001;&#x6E05;&#x6D17;&#x3001;&#x91CD;&#x5851;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8FDB;&#x4E00;&#x6B65;&#x5B66;&#x4E60;matplotlib&#x6570;&#x636E;&#x53EF;&#x89C6;&#x5316;&#x3002;&#x6211;&#x4EEC;&#x5728;&#x7A0D;&#x540E;&#x4F1A;&#x56DE;&#x5230;pandas&#xFF0C;&#x5B66;&#x4E60;&#x66F4;&#x9AD8;&#x7EA7;&#x7684;&#x5206;&#x6790;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="07.html" class="navigation navigation-prev " aria-label="Previous page: 第07章 数据清洗和准备.md">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="09.html" class="navigation navigation-next " aria-label="Next page: 第09章 绘图和可视化">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"第08章 数据规整：聚合、合并和重塑","level":"1.9","depth":1,"next":{"title":"第09章 绘图和可视化","level":"1.10","depth":1,"path":"09.md","ref":"./09.md","articles":[]},"previous":{"title":"第07章 数据清洗和准备.md","level":"1.8","depth":1,"path":"07.md","ref":"./07.md","articles":[]},"dir":"ltr"},"config":{"plugins":["livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"fontsettings":{"theme":"white","family":"serif","size":2},"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"利用Python进行数据分析·第2版","language":"zh-hans","links":{"sidebar":{"首页":"https://www.mapull.com"}},"gitbook":"*"},"file":{"path":"08.md","mtime":"2023-01-10T14:06:34.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-01-10T16:36:24.079Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

